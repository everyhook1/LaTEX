<body><section level="1" type="TextBox" id="section1"><section level="2" id="section2"><title>Author Summary</title><p id="para2"> Loops in proteins are flexible regions connecting regular secondarystructures. They are often involved in protein functions throughinteracting with other molecules. The irregularity and flexibilityof loops make their structures difficult to determine experimentallyand challenging to model computationally. Despite significantprogress made in the past in loop modeling, current methods stillcannot generate near&hyphen;native loop conformations rapidly. In thisstudy, we develop a fast chain&hyphen;growth method for loop modeling, called Distance&hyphen;guided Sequential chain&hyphen;Growth Monte Carlo&lpar;
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&rpar;, to efficiently generate high quality near&hyphen;native loopconformations. The generated loops can be used directly or ascandidates for further refinement. </p></section></section>
<section level="1" id="section3"><title>Introduction</title><p id="para3"> Protein loops connect regular secondary structures and are flexibleregions on protein surface. They often play important functionalroles in recognition and binding of small molecules or otherproteins&nbsp; <citref rids="ref1 ref2 ref3">1&ndash;3</citref> . Theflexibility and irregularity of loops make their structuresdifficult to resolve experimentally&nbsp; <citref rids="ref4">4</citref> . They are alsochallenging to model computationally&nbsp; <citref rids="ref5 ref6">5,6</citref> . Prediction of loop conformations is an important problem and hasreceived considerableattention&nbsp; <citref rids="ref5 ref6 ref7 ref8 ref9 ref10 ref11 ref12 ref13 ref14 ref15 ref16 ref17 ref18 ref19 ref20 ref21 ref22 ref23 ref24 ref25 ref26 ref27">5&ndash;27</citref> . </p><p id="para4">Among existing methods for loop prediction, template&hyphen;free methodsbuild loop structures {\itdenovo}<emph type="italic">de novo</emph>through conformationalsearch&nbsp; <citref rids="ref5 ref6 ref7 ref9 ref10 ref13 ref14 ref17 ref18 ref21 ref23 ref28">5&ndash;7,9,10,13,14,17,18,21,23,28</citref> . Template&hyphen;based methods build loops by using loop fragments extractedfrom known protein structures in the Protein DataBank&nbsp; <citref rids="ref11 ref19 ref27">11,19,27</citref> . Recentadvances in template&hyphen;free loop modeling have enabled prediction ofstructures of long loops with impressive accuracy when crystalcontacts or protein family specific information such as that of GPCRfamily is taken into account&nbsp; <citref rids="ref14 ref23 ref25">14,23,25</citref> . </p><p id="para5">Loop modeling can be considered as a miniaturized protein foldingproblem. However, several factors make it much more challenging thanfolding small peptides. First, a loop conformation needs to connecttwo fixed ends with desired bond lengths andangles&nbsp; <citref rids="ref8 ref12">8,12</citref> . Generating quality loopconformations satisfying this geometric constraint is nontrivial. Second, the complex interactions between atoms in a loop and thosein its surrounding make the energy landscape around near&hyphen;native loopconformations quite rugged. Water molecules, which are oftenimplicitly modeled in most loop sampling methods, may contributesignificantly to the energetics of loops. Hydrogen bonding networksaround loops are usually more complex and difficult to model thanthose in regular secondary structures. Third, since loops arelocated on the surface of proteins, conformational entropy may alsoplay more prominent roles in the stability of near&hyphen;native loopconformations&nbsp; <citref rids="ref29 ref30">29,30</citref> . Approaches based onenergy optimization, which ignore backbone and&sol;or side chainconformational entropies, may be biased toward those overly compactnon&hyphen;native structures. Despite extensive studies in the past andsignificant progress made in recent years, both conformationalsampling and energy evaluation remain challenging problems, especially for long loops&lpar;<emph type="italic">e. g. </emph>, <equ id="equ12" type="inline">
<tex>
$n\ge12$

</tex></equ>
&rpar;. </p><p id="para6">In this paper, we propose a novel method for loop sampling, calledDistance&hyphen;guided Sequential chain&hyphen;Growth Monte Carlo&lpar;D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&rpar;. Based on the principle of chaingrowth&nbsp; <citref rids="ref15 ref31 ref32 ref33 ref34">15,31&ndash;34</citref> , the strategy of sampling through sequentially growing protein chainsallows efficient exploration of conformationalspace&nbsp; <citref rids="ref15 ref33 ref34 ref35 ref36">15,33&ndash;36</citref> . Forexample, the Fragment Regrowth by Energy&hyphen;guided Sequential Sampling&lpar;FRESS&rpar;method outperformed previous methods on benchmark HPsequence folding problem&nbsp; <citref rids="ref15 ref37">15,37</citref> . In addition toHP model&nbsp; <citref rids="ref15">15</citref> , sequential chain&hyphen;growth sampling hasbeen used to study protein packing and voidformation&nbsp; <citref rids="ref34">34</citref> , side chainentropy&nbsp; <citref rids="ref29 ref38">29,38</citref> , protein near&hyphen;native structuresampling&nbsp; <citref rids="ref30">30</citref> , structure generation from contactmaps&nbsp; <citref rids="ref39">39</citref> , reconstruction of transition state ensemble ofprotein folding&nbsp; <citref rids="ref40">40</citref> , RNA loop entropycalculation&nbsp; <citref rids="ref36">36</citref> , and structure prediction ofpseudo&hyphen;knotted RNA molecules&nbsp; <citref rids="ref41">41</citref> . </p><p id="para7">In this study, we first derive empirical distributions of end&hyphen;to&hyphen;enddistances of loops of different lengths, as well as empiricaldistributions of backbone dihedral angles of different residue typesfrom a loop database constructed from known protein structures. Anempirical distance guidance function is then employed to bias thegrowth of loop fragments towards the<equ id="equ13" type="inline">
<tex>
$C$

</tex></equ>
&hyphen;terminal end of the loop. The backbone dihedral angle distribution is used to sampleenergetically favorable dihedral angles, which lead to improvedexploration of low energy loop conformations. Computational cost isreduced by using a method consisted of exclusion by REsidue&hyphen;residueDistance Cutoff and ELLipsoid criterion, called {\scRedcell}R<emph type="smallcaps">edcell</emph>. Sampled loop conformations, all free of steric clashes, can bescored and ranked efficiently using an atom&hyphen;based distance&hyphen;dependentempirical potential function specifically designed for loops. </p><p id="para8">Our paper is organized as follows. We first describe our model andthe {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> sampling method in detail. We then present resultsfor structure prediction using five different test data sets. Weshow that {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> has significant advantages in generatingnative&hyphen;like loops. Accurate loops can be constructed by using {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> combined with a specifically designed atom&hyphen;baseddistance&hyphen;dependent empirical potential function. Our method is alsocomputationally more efficient compared to previousmethods&nbsp; <citref rids="ref8 ref9 ref18 ref22 ref42">8,9,18,22,42</citref> . </p></section>
<section level="1" id="section4"><title>Results</title>
<section level="2" id="section5"><title> Test set</title><p id="para9"> We use five data sets as our test sets. Test Set 1  contains<equ id="equ14" type="inline">
<tex>
$10$

</tex></equ>
loops at lengths four, eight, and twelve, for a total of<equ id="equ15" type="inline">
<tex>
$3\times10=30$

</tex></equ>
loops from<equ id="equ16" type="inline">
<tex>
$21$

</tex></equ>
PDB structures, which were describedin Table 2  of Ref. &nbsp; <citref rids="ref8">8</citref> . Test Set 2  consists of<equ id="equ17" type="inline">
<tex>
$53$

</tex></equ>
eight, <equ id="equ18" type="inline">
<tex>
$17$

</tex></equ>
eleven, and<equ id="equ19" type="inline">
<tex>
$10$

</tex></equ>
twelve&hyphen;residue loops from Table C1 ofRef. &nbsp; <citref rids="ref42">42</citref> . Several loop structures were removed as theywere nine&hyphen;residue loops but mislabeled as eight&hyphen;residue loops&colon;&lpar;1  awd, 55 &ndash;63 &semi;1  byb, 246 &ndash;254 &semi;and {\tt1ptf} 1  ptf, 10 &ndash;18 &rpar;. Altogether, there are<equ id="equ20" type="inline">
<tex>
$50$

</tex></equ>
eight&hyphen;residue loops. Test Set 3  is asubset of that of&nbsp; <citref rids="ref5">5</citref> , which was used in the RAPPER andthe FALCm studies&nbsp; <citref rids="ref10 ref22">10,22</citref> . Details of this setcan be found in the&ldquo;Fiser Benchmark Set&rdquo;section ofRef. &nbsp; <citref rids="ref10">10</citref> . Test Set 4  is taken from Table A1&ndash;A6 ofRef. &nbsp; <citref rids="ref42">42</citref> . Test Set 5  contains<equ id="equ21" type="inline">
<tex>
$36$

</tex></equ>
fourteen, <equ id="equ22" type="inline">
<tex>
$30$

</tex></equ>
fifteen, <equ id="equ23" type="inline">
<tex>
$14$

</tex></equ>
sixteen and<equ id="equ24" type="inline">
<tex>
$9$

</tex></equ>
seventeen&hyphen;residue loops from Table 3 of Ref. &nbsp; <citref rids="ref23">23</citref> . Test Set 1  and 2  are used for testing thecapability of {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> and other methods in generatingnative&hyphen;like loops. Test Set 3 , 4 , and 5  are used for assessing theaccuracy of predicted loops based on selection from energyevaluation using our atom&hyphen;based distance&hyphen;dependent empiricalpotential function. Our results are reported as global backboneRMSD, calculated using the N, <equ id="equ25" type="inline">
<tex>
$\mathrm{C_{\alpha}}$

</tex></equ>
, C and O atomsin the backbone. </p></section>
<section level="2" id="section6"><title>Loop sampling</title><p id="para10"> To evaluate how good our method is in producing native&hyphen;like loopconformations, we use Test Set 1  and 2  to evaluate {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>. </p><p id="para11">We generated<equ id="equ26" type="inline">
<tex>
$5,000$

</tex></equ>
loops for each of the<equ id="equ27" type="inline">
<tex>
$10$

</tex></equ>
loop structurescontained in Test Set 1  at length<equ id="equ28" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ29" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ30" type="inline">
<tex>
$12$

</tex></equ>
residues, respectively. We compare our results with those obtained byCCD&nbsp; <citref rids="ref8">8</citref> , CSJD&nbsp; <citref rids="ref12">12</citref> , SOS&nbsp; <citref rids="ref18">18</citref> , and FALCm&nbsp; <citref rids="ref22">22</citref> . The minimum RMSD among<equ id="equ31" type="inline">
<tex>
$5,000$

</tex></equ>
sampled loops generated by {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> are listed inTable&nbsp;<tblref rids="tbl1">Table&#146;1</tblref>, along with results from the four othermethods. </p><p id="para12">Accurate loops of longer length are more difficult to generate. Forloops with<equ id="equ32" type="inline">
<tex>
$12$

</tex></equ>
residues, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>generates more accurate loopsthan other methods. Our method has a mean of<equ id="equ33" type="inline">
<tex>
$1.53$

</tex></equ>
rAfortheminimum RMSD, compared to<equ id="equ34" type="inline">
<tex>
$1.81$

</tex></equ>
rAforFALCm, the next bestmethod in the group&nbsp; <citref rids="ref22">22</citref> . The minimum RMSD of nine of theten<equ id="equ35" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops have RMSD<equ id="equ36" type="inline">
<tex>
$\le2$

</tex></equ>
rA, while five loops ofthe ten targets generated by FALCm have RMSD<equ id="equ37" type="inline">
<tex>
$>2$

</tex></equ>
rA. Compared tothe CCD, CSJD, and SOS methods, our loops have significantly smallerminimum RMSD&lpar;<equ id="equ38" type="inline">
<tex>
$1.53$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ39" type="inline">
<tex>
$3.05$

</tex></equ>
, <equ id="equ40" type="inline">
<tex>
$2.34$

</tex></equ>
, and<equ id="equ41" type="inline">
<tex>
$2.25$

</tex></equ>
rA, respectively, Table&nbsp;<tblref rids="tbl1">Table&#146;1</tblref>&rpar;. The average minimumglobal backbone RMSD for<equ id="equ42" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops can be further improvedwhen we increase the sample size of generated loop conformations. The minimum global RMSD is improved to<equ id="equ43" type="inline">
<tex>
$1.45$

</tex></equ>
rA, <equ id="equ44" type="inline">
<tex>
$1.26$

</tex></equ>
rA, and<equ id="equ45" type="inline">
<tex>
$0.96$

</tex></equ>
rAwhenthe sample size is increased to 20 , 000 , 100 , 000 , and 1 , 000 , 000 , respectively. Further improvement wouldlikely require flexible bond lengths and angles. </p><p id="para13">For loops with<equ id="equ46" type="inline">
<tex>
$8$

</tex></equ>
residues, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has an average minimumRMSD value smaller than the CCD, CSJD, and SOS methods&lpar;<equ id="equ47" type="inline">
<tex>
$0.81$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ48" type="inline">
<tex>
$1.59$

</tex></equ>
rA, <equ id="equ49" type="inline">
<tex>
$1.01$

</tex></equ>
rA, and<equ id="equ50" type="inline">
<tex>
$1.19$

</tex></equ>
rA, respectively, Table&nbsp;<tblref rids="tbl1">Table&#146;1</tblref>&rpar;. In eight of the ten<equ id="equ51" type="inline">
<tex>
$8$

</tex></equ>
&hyphen;residue loops, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>achieves sub&hyphen;angstrom accuracy&lpar;RMSD<equ id="equ52" type="inline">
<tex>
$<1$

</tex></equ>
rA&rpar;, although the mean of minimum RMSD of<equ id="equ53" type="inline">
<tex>
$8$

</tex></equ>
&hyphen;residue loopsis slightly larger than that from FALCm&lpar;<equ id="equ54" type="inline">
<tex>
$0.80$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ55" type="inline">
<tex>
$0.72$

</tex></equ>
rA&rpar;. </p><p id="para14">For loops with<equ id="equ56" type="inline">
<tex>
$4$

</tex></equ>
&hyphen;residue, the mean of the minimum RMSD&lpar;<equ id="equ57" type="inline">
<tex>
$0.21$

</tex></equ>
rA&rpar;by {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> is significantly smallerthan those by the CSJD and the CCD methods&lpar;<equ id="equ58" type="inline">
<tex>
$0.40$

</tex></equ>
rAand<equ id="equ59" type="inline">
<tex>
$0.56$

</tex></equ>
rA, respectively&rpar;, and is similar to those by the SOS and FALCmmethods&lpar;<equ id="equ60" type="inline">
<tex>
$0.20$

</tex></equ>
rAand<equ id="equ61" type="inline">
<tex>
$0.22$

</tex></equ>
rA, respectively&rpar;. Noticeably, three of the ten loops have RMSD<equ id="equ62" type="inline">
<tex>
$<0.1$

</tex></equ>
rA, indicating oursampling method has good accuracy for short loop modeling. </p><p id="para15">These loops can be generated rapidly. The computing time perconformation averaged over 5 , 000  conformations for<equ id="equ63" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ64" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ65" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residues is<equ id="equ66" type="inline">
<tex>
$4.4$

</tex></equ>
, <equ id="equ67" type="inline">
<tex>
$13$

</tex></equ>
, and<equ id="equ68" type="inline">
<tex>
$20\:ms$

</tex></equ>
using a single AMDOpteron processor of<equ id="equ69" type="inline">
<tex>
$2\:GHz$

</tex></equ>
. In addition to improved averageminimum RMSD, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>seems to take less time than CCD&lpar;<equ id="equ70" type="inline">
<tex>
$31$

</tex></equ>
, <equ id="equ71" type="inline">
<tex>
$37$

</tex></equ>
, and<equ id="equ72" type="inline">
<tex>
$23\:ms$

</tex></equ>
on an AMD 1800 &plus;MP processor for the<equ id="equ73" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ74" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ75" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops&rpar;, and is as efficient as SOS&lpar;<equ id="equ76" type="inline">
<tex>
$5.0$

</tex></equ>
, <equ id="equ77" type="inline">
<tex>
$13$

</tex></equ>
, and<equ id="equ78" type="inline">
<tex>
$19\:ms$

</tex></equ>
for the<equ id="equ79" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ80" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ81" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops on an AMD1800 &plus;MP processor&rpar;. </p><p id="para16">Reducing the number of trial states in {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> can furtherreduce the computing time, with some trade&hyphen;off in sampling accuracy. For example, when we take<equ id="equ82" type="inline">
<tex>
$(m,\,n)=(10,\,2)$

</tex></equ>
, the computingtime per conformation averaged over 5 , 000  conformations for<equ id="equ83" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ84" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ85" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residues is only<equ id="equ86" type="inline">
<tex>
$3.5$

</tex></equ>
, <equ id="equ87" type="inline">
<tex>
$5.0$

</tex></equ>
, and<equ id="equ88" type="inline">
<tex>
$5.8\:ms$

</tex></equ>
, respectively, with the average minimum RMSDs comparable to thosefrom SOS&rsquo;s&lpar;<equ id="equ89" type="inline">
<tex>
$0.29$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ90" type="inline">
<tex>
$0.20$

</tex></equ>
rA, <equ id="equ91" type="inline">
<tex>
$1.15$

</tex></equ>
rA<emph type="italic">vs</emph><equ id="equ92" type="inline">
<tex>
$1.19$

</tex></equ>
rA, and<equ id="equ93" type="inline">
<tex>
$2.24$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ94" type="inline">
<tex>
$2.25$

</tex></equ>
rAfor the<equ id="equ95" type="inline">
<tex>
$4$

</tex></equ>
, <equ id="equ96" type="inline">
<tex>
$8$

</tex></equ>
, and<equ id="equ97" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops, respectively&rpar;. Althoughthe CSJD loop closure method has faster computing time&lpar;<equ id="equ98" type="inline">
<tex>
$0.56$

</tex></equ>
, <equ id="equ99" type="inline">
<tex>
$0.68$

</tex></equ>
, and<equ id="equ100" type="inline">
<tex>
$0.72\:ms$

</tex></equ>
on AMD 1800 &plus;MP processor&rpar;, the speed of {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> is adequate in practical applications. </p><p id="para17">We compare {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> in generating near&hyphen;native loops withWriggling&nbsp; <citref rids="ref43">43</citref> , Random Tweak&nbsp; <citref rids="ref44">44</citref> , DirectTweak&nbsp; <citref rids="ref42 ref45">42,45</citref> , <equ id="equ101" type="inline">
<tex>
$\mathrm{LOOPY_{bb}}$

</tex></equ>
&nbsp; <citref rids="ref45">45</citref> , andPLOP&hyphen;build&nbsp; <citref rids="ref13">13</citref> using Test Set 2 . The minimum RMSDamong<equ id="equ102" type="inline">
<tex>
$5,000$

</tex></equ>
loops generated by {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> are listed inTable&nbsp;<tblref rids="tbl2">Table&#146;2</tblref>, along with results from the othermethods obtained from Table 2  in Ref. &nbsp; <citref rids="ref42">42</citref> . Direct Tweakand<equ id="equ103" type="inline">
<tex>
$\mathrm{LOOPY_{bb}}$

</tex></equ>
from the LoopBuilder method and our {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> have better accuracy in sampling than Wriggling, RandomTweak, and PLOP&hyphen;build methods. For loops with 11  and 12 &hyphen;residues, these three methods are the only ones that can generate near&hyphen;nativeloop structures with minimal RMSD values below<equ id="equ104" type="inline">
<tex>
$2$

</tex></equ>
rA. Amongthese, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>outperforms<equ id="equ105" type="inline">
<tex>
$\mathrm{LOOPY_{bb}}$

</tex></equ>
in generatingloops at all three lengths&colon;the average minimal RMSD&lpar;<equ id="equ106" type="inline">
<tex>
$R_{\rm
min}$

</tex></equ>
&rpar;is<equ id="equ107" type="inline">
<tex>
$1.28$

</tex></equ>
rA{\itvs.}\<emph type="italic">vs. </emph><equ id="equ108" type="inline">
<tex>
$1.80$

</tex></equ>
rAforlength<equ id="equ109" type="inline">
<tex>
$12$

</tex></equ>
, <equ id="equ110" type="inline">
<tex>
$1.19$

</tex></equ>
rA{\itvs.}\<emph type="italic">vs. </emph><equ id="equ111" type="inline">
<tex>
$1.51$

</tex></equ>
rAforlength<equ id="equ112" type="inline">
<tex>
$11$

</tex></equ>
, and<equ id="equ113" type="inline">
<tex>
$0.80$

</tex></equ>
rA{\itvs.}\<emph type="italic">vs. </emph><equ id="equ114" type="inline">
<tex>
$0.89$

</tex></equ>
rAforlength<equ id="equ115" type="inline">
<tex>
$8$

</tex></equ>
, respectively. Compared to the DirectTweak sampling method, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has improved<equ id="equ116" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
for<equ id="equ117" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops&lpar;<equ id="equ118" type="inline">
<tex>
$1.28$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ119" type="inline">
<tex>
$1.48$

</tex></equ>
rA&rpar;, slightlyimproved<equ id="equ120" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
for<equ id="equ121" type="inline">
<tex>
$11$

</tex></equ>
&hyphen;residue loops&lpar;<equ id="equ122" type="inline">
<tex>
$1.19$

</tex></equ>
rA{\it
vs}<emph type="italic">vs</emph><equ id="equ123" type="inline">
<tex>
$1.20$

</tex></equ>
rA&rpar;and inferior<equ id="equ124" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
for<equ id="equ125" type="inline">
<tex>
$8$

</tex></equ>
&hyphen;residue loops&lpar;<equ id="equ126" type="inline">
<tex>
$0.80$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ127" type="inline">
<tex>
$0.69$

</tex></equ>
rA&rpar;. Overall, these resultsshow that {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> are very effective in sampling near&hyphen;nativeloop conformations, especially when modeling longer loops of length11  and 12 . </p><p id="para18">Our {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> method can generate accurate loops and hassignificant advantages for longer loops compared to previousmethods. Using RMSD values calculated from three backbone atoms N, <equ id="equ128" type="inline">
<tex>
$\mathrm{C_{\alpha}}$

</tex></equ>
, and C for all loop lengths lead to the sameconclusion. </p></section>
<section level="2" id="section7"><title>Loop structure prediction and energy evaluation</title><p id="para19"> To assess the accuracy of predicted loops based on selection fromenergy evaluation using our specifically designed atom&hyphen;baseddistance&hyphen;dependent empirical potential function, we test {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> using Test Set 3  and follow the approach ofreference&nbsp; <citref rids="ref22">22</citref> for ease of comparison. Because of the highcontent of secondary structure, these loops are very challenging tomodel. In the study of&nbsp; <citref rids="ref22">22</citref> , <equ id="equ129" type="inline">
<tex>
$1,000$

</tex></equ>
backboneconformations with the best scores of the DFIRE potentialfunction&nbsp; <citref rids="ref46">46</citref> were retained after screening<equ id="equ130" type="inline">
<tex>
$4,000$

</tex></equ>
generated backbone conformations for each loop. Loop closure andsteric clash removal were not enforced to the<equ id="equ131" type="inline">
<tex>
$4,000$

</tex></equ>
conformations. We follow the same procedure, except the DFIRE potential function isreplaced by our atom&hyphen;based distance&hyphen;dependent empirical potentialfunction. The ensemble of the selected<equ id="equ132" type="inline">
<tex>
$1,000$

</tex></equ>
backboneconformations are then subjected to the procedure of side&hyphen;chainconstruction as described in the Section&ldquo;Side&hyphen;chain modeling andsteric clash removal&rdquo;. The loop conformations with full side&hyphen;chainsare then scored and ranked by the atom&hyphen;based distance&hyphen;dependentempirical potential function. Our results are summarized inTable&nbsp;<tblref rids="tbl3">Table&#146;3</tblref>. </p><p id="para20">We measure the average minimum backbone RMSD<equ id="equ133" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
, theaverage ensemble RMSD<equ id="equ134" type="inline">
<tex>
$R_{\rmave}$

</tex></equ>
, and the average RMSD of thelowest energy conformations<equ id="equ135" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
of the 1 , 000  loop ensemblewith the same length. Overall, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>performs significantlybetter than FALCm and RAPPER in<equ id="equ136" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
, <equ id="equ137" type="inline">
<tex>
$R_{\rmave}$

</tex></equ>
and<equ id="equ138" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
for all loop lengths. Compared to FALCm, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>shows significant advantages in<equ id="equ139" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
on sampling long loopsof<equ id="equ140" type="inline">
<tex>
$10$

</tex></equ>
&ndash;<equ id="equ141" type="inline">
<tex>
$12$

</tex></equ>
residues. Our method has<equ id="equ142" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
of<equ id="equ143" type="inline">
<tex>
$1.15$

</tex></equ>
rAcomparedto<equ id="equ144" type="inline">
<tex>
$1.45$

</tex></equ>
rAfor<equ id="equ145" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops, <equ id="equ146" type="inline">
<tex>
$1.39$

</tex></equ>
rAcomparedto<equ id="equ147" type="inline">
<tex>
$1.47$

</tex></equ>
rAfor<equ id="equ148" type="inline">
<tex>
$11$

</tex></equ>
&hyphen;residue loops, and<equ id="equ149" type="inline">
<tex>
$1.53$

</tex></equ>
rAcomparedto<equ id="equ150" type="inline">
<tex>
$1.74$

</tex></equ>
rAfor<equ id="equ151" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops, respectively. For example, as can be seen in Figure&nbsp;<figref rids="fig1">Figure&#146;1</figref>, the lowest energy loop&lpar;red&rpar;of a 12 &hyphen;residue loop in the protein1  scs&lpar;residues 199 &hyphen;210 &rpar;has a<equ id="equ152" type="inline">
<tex>
$0.9$

</tex></equ>
rARMSDto the nativestructure&lpar;white&rpar;. The generated top five lowest energy loops areall very close to the native loop, yet are diverse among themselves. </p><p id="para21">D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>also generates loops with smaller<equ id="equ153" type="inline">
<tex>
$R_{\rmave}$

</tex></equ>
compared to FALCm in loops with length ranging from<equ id="equ154" type="inline">
<tex>
$4$

</tex></equ>
to<equ id="equ155" type="inline">
<tex>
$12$

</tex></equ>
, indicating {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> can generate ensemble of loop conformationswith enriched near native conformations. Furthermore {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>achieves better modeling accuracy using the atom&hyphen;baseddistance&hyphen;dependent empirical potential function. Compared to FALCm, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has a<equ id="equ156" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
of<equ id="equ157" type="inline">
<tex>
$1.72$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ158" type="inline">
<tex>
$1.87$

</tex></equ>
rAfor<equ id="equ159" type="inline">
<tex>
$8$

</tex></equ>
&hyphen;residue loops, <equ id="equ160" type="inline">
<tex>
$1.82$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ161" type="inline">
<tex>
$2.08$

</tex></equ>
rAfor<equ id="equ162" type="inline">
<tex>
$9$

</tex></equ>
&hyphen;residue loops, <equ id="equ163" type="inline">
<tex>
$2.33$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ164" type="inline">
<tex>
$3.09$

</tex></equ>
rAfor<equ id="equ165" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops, <equ id="equ166" type="inline">
<tex>
$2.98$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ167" type="inline">
<tex>
$3.43$

</tex></equ>
rAfor<equ id="equ168" type="inline">
<tex>
$11$

</tex></equ>
&hyphen;residue loops, and<equ id="equ169" type="inline">
<tex>
$2.99$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ170" type="inline">
<tex>
$3.84$

</tex></equ>
rAfor<equ id="equ171" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops, respectively. </p><p id="para22">D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>is also much faster than other methods. The reportedtypical computational cost of FALCm is<equ id="equ172" type="inline">
<tex>
$180$

</tex></equ>
cpu minutes for<equ id="equ173" type="inline">
<tex>
$8$

</tex></equ>
&ndash;<equ id="equ174" type="inline">
<tex>
$12$

</tex></equ>
residue loops on a Linux server of a<equ id="equ175" type="inline">
<tex>
$2.8\:GHz$

</tex></equ>
2 &hyphen;coreIntel Xeon processor&nbsp; <citref rids="ref47">47</citref> . The computation cost for {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> method is only<equ id="equ176" type="inline">
<tex>
$6$

</tex></equ>
and 10  cpu minutes for<equ id="equ177" type="inline">
<tex>
$10$

</tex></equ>
and12 &ndash;residue loops on a single<equ id="equ178" type="inline">
<tex>
$2\:GHz$

</tex></equ>
AMD Opteron processor, respectively. In addition, FALCm has a size restriction, and it onlyworks with proteins with<equ id="equ179" type="inline">
<tex>
$<500$

</tex></equ>
residues. In contrast, the overallprotein size has no effect on the computational efficiency of {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> once all of the rest of the protein residues have beentested using the ellipsoid criterion. </p><p id="para23">The LOOPER method is an accurate and efficient loop modeling methodusing a minimal conformational sampling method combined with energyminimization&nbsp; <citref rids="ref17">17</citref> . The test set used in the LOOPERstudy are the original Fiser data set without removal of any loops. Therefore, it is different from Test Set 3  used in the RAPPER andFALCm studies&nbsp; <citref rids="ref10 ref22">10,22</citref> . For ease of comparison, we compare our {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> method to the LOOPER method using thetest set with<equ id="equ180" type="inline">
<tex>
$10$

</tex></equ>
&ndash;<equ id="equ181" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops from&nbsp; <citref rids="ref17">17</citref> . Ourresults are summarized in Table&nbsp;<tblref rids="tbl4">Table&#146;4</tblref>. </p><p id="para24">We denote<equ id="equ182" type="inline">
<tex>
$R_{\rmBkb,ave}$

</tex></equ>
and<equ id="equ183" type="inline">
<tex>
$R_{\rmBkb,med}$

</tex></equ>
as the mean andmedian of backbone RMSD of the lowest energy conformations with thesame loop length. Similarly, we use<equ id="equ184" type="inline">
<tex>
$R_{\rmAtm,ave}$

</tex></equ>
, and<equ id="equ185" type="inline">
<tex>
$R_{\rm
Atm,med}$

</tex></equ>
to denote the mean and median RMSD values of all&hyphen;heavyatoms RMSD. D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>shows improved prediction accuracy comparedto LOOPER in both backbones and all&hyphen;heavy atoms RMSD. For the<equ id="equ186" type="inline">
<tex>
$40$

</tex></equ>
loops of length 12 , <equ id="equ187" type="inline">
<tex>
$R_{\rmBkb,ave}$

</tex></equ>
is<equ id="equ188" type="inline">
<tex>
$3.20$

</tex></equ>
rAcomparedto<equ id="equ189" type="inline">
<tex>
$4.08$

</tex></equ>
rA, while the median<equ id="equ190" type="inline">
<tex>
$R_{\rmBkb,med}$

</tex></equ>
is<equ id="equ191" type="inline">
<tex>
$2.39$

</tex></equ>
rAcompared to<equ id="equ192" type="inline">
<tex>
$3.80$

</tex></equ>
rA. It also has better all&hyphen;heavy atom RMSD of<equ id="equ193" type="inline">
<tex>
$3.39$

</tex></equ>
rA&sol;<equ id="equ194" type="inline">
<tex>
$3.18$

</tex></equ>
rA&lpar;mean&sol;median&rpar;, compared to<equ id="equ195" type="inline">
<tex>
$3.58$

</tex></equ>
rA&sol;<equ id="equ196" type="inline">
<tex>
$3.35$

</tex></equ>
rAfor<equ id="equ197" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops, <equ id="equ198" type="inline">
<tex>
$3.58$

</tex></equ>
rA&sol;<equ id="equ199" type="inline">
<tex>
$3.30$

</tex></equ>
rAcomparedto<equ id="equ200" type="inline">
<tex>
$4.30$

</tex></equ>
rA&sol;<equ id="equ201" type="inline">
<tex>
$3.60$

</tex></equ>
rAfor<equ id="equ202" type="inline">
<tex>
$11$

</tex></equ>
&hyphen;residueloops, and<equ id="equ203" type="inline">
<tex>
$4.18$

</tex></equ>
rA&sol;<equ id="equ204" type="inline">
<tex>
$3.60$

</tex></equ>
rAcomparedto<equ id="equ205" type="inline">
<tex>
$5.22$

</tex></equ>
rA&sol;<equ id="equ206" type="inline">
<tex>
$4.96$

</tex></equ>
rAfor<equ id="equ207" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops. </p><p id="para25">It is worth noting that {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> outperforms LOOPER in speed aswell. For a loop with<equ id="equ208" type="inline">
<tex>
$10$

</tex></equ>
residues, the time cost of {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>is<equ id="equ209" type="inline">
<tex>
$6$

</tex></equ>
minutes using a<equ id="equ210" type="inline">
<tex>
$2\:GHz$

</tex></equ>
CPU versus<equ id="equ211" type="inline">
<tex>
$40$

</tex></equ>
cpu minutes using a<equ id="equ212" type="inline">
<tex>
$3\:GHz$

</tex></equ>
processor according to Figure&nbsp;<equ id="equ213" type="inline">
<tex>
$7$

</tex></equ>
in the LOOPERpaper&nbsp; <citref rids="ref17">17</citref> . </p><p id="para26">Prior publications also allowed us to compare results in loopstructure predictions based on energy discrimination using Test Set4  with results obtained using the LoopBuildermethod&nbsp; <citref rids="ref42">42</citref> . Following&nbsp; <citref rids="ref42">42</citref> , we generated<equ id="equ214" type="inline">
<tex>
$1,000$

</tex></equ>
closed loop conformations foreight&hyphen;residue loops, <equ id="equ215" type="inline">
<tex>
$2,000$

</tex></equ>
for nine&hyphen;residue loops, <equ id="equ216" type="inline">
<tex>
$5,000$

</tex></equ>
forten, eleven, and twelve&hyphen;residue loops, and<equ id="equ217" type="inline">
<tex>
$8,000$

</tex></equ>
forthirteen&hyphen;residue loops. Energy calculations are carried out usingour atom&hyphen;based distance&hyphen;dependent empirical potential function. Theaverage RMSD of the lowest energy conformations, <equ id="equ218" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
, arethen compared between these two methods. The results are summarizedin Table&nbsp;<tblref rids="tbl5">Table&#146;5</tblref>. </p><p id="para27">Compared to LoopBuilder, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has better<equ id="equ219" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
&colon;<equ id="equ220" type="inline">
<tex>
$1.83$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ221" type="inline">
<tex>
$1.88$

</tex></equ>
rAfor<equ id="equ222" type="inline">
<tex>
$9$

</tex></equ>
&hyphen;residue loops, <equ id="equ223" type="inline">
<tex>
$1.83$

</tex></equ>
rA<emph type="italic">vs</emph><equ id="equ224" type="inline">
<tex>
$1.93$

</tex></equ>
rAfor<equ id="equ225" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops, <equ id="equ226" type="inline">
<tex>
$2.38$

</tex></equ>
rA{\it
vs}<emph type="italic">vs</emph><equ id="equ227" type="inline">
<tex>
$2.50$

</tex></equ>
rAfor<equ id="equ228" type="inline">
<tex>
$11$

</tex></equ>
&hyphen;residue loops, <equ id="equ229" type="inline">
<tex>
$2.62$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ230" type="inline">
<tex>
$2.65$

</tex></equ>
rAfor<equ id="equ231" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops, and<equ id="equ232" type="inline">
<tex>
$3.26$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ233" type="inline">
<tex>
$3.74$

</tex></equ>
rAfor<equ id="equ234" type="inline">
<tex>
$13$

</tex></equ>
&hyphen;residue loops, respectively. D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>hasinferior performance in selecting<equ id="equ235" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
for<equ id="equ236" type="inline">
<tex>
$8$

</tex></equ>
&hyphen;residue loops&lpar;<equ id="equ237" type="inline">
<tex>
$1.59$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ238" type="inline">
<tex>
$1.31$

</tex></equ>
rA&rpar;. The average time usingLoopBuilder for twelve&hyphen;residue loops was around 4.5 hours or 270 minutes, while the computational time using {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> is around10  minutes. Overall, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has equal or slightly betterperformance than LoopBuilder in average prediction accuracy of loopstructures with far less computing time. </p><p id="para28">To test the feasibility of {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> in modeling longer loopswith length<equ id="equ239" type="inline">
<tex>
$>12$

</tex></equ>
, we use the Fiser<equ id="equ240" type="inline">
<tex>
$13$

</tex></equ>
&hyphen;residue loops data set togenerate and select low energy loop conformations. <equ id="equ241" type="inline">
<tex>
$1,000$

</tex></equ>
conformations with low energy are obtained. The mean of minimumbackbone RMSD<equ id="equ242" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
of<equ id="equ243" type="inline">
<tex>
$40$

</tex></equ>
loops with<equ id="equ244" type="inline">
<tex>
$13$

</tex></equ>
&hyphen;residue is<equ id="equ245" type="inline">
<tex>
$1.76$

</tex></equ>
rA, and the median is<equ id="equ246" type="inline">
<tex>
$1.61$

</tex></equ>
rA. The mean&sol;median of thebackbones RMSD<equ id="equ247" type="inline">
<tex>
$R_{Bkb,Emin}$

</tex></equ>
, and all heavy atoms RMSD<equ id="equ248" type="inline">
<tex>
$R_{\rm
Atm,Emin}$

</tex></equ>
of the lowest energy conformations are<equ id="equ249" type="inline">
<tex>
$2.91$

</tex></equ>
rA&sol;<equ id="equ250" type="inline">
<tex>
$2.53$

</tex></equ>
rAand<equ id="equ251" type="inline">
<tex>
$3.84$

</tex></equ>
rA&sol;<equ id="equ252" type="inline">
<tex>
$3.29$

</tex></equ>
rA, respectively&lpar;Table&nbsp;<tblref rids="tbl6">Table&#146;6</tblref>&rpar;. </p><p id="para29">With extensive conformational sampling using molecular mechanicsforce field, the Protein Local Optimization Program&lpar;PLOP&rpar;canpredict highly accurate loops&nbsp; <citref rids="ref13 ref14 ref23">13,14,23</citref> . We tested {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> using Test Set 5  consisting of<equ id="equ253" type="inline">
<tex>
$89$

</tex></equ>
loopswith length<equ id="equ254" type="inline">
<tex>
$14$

</tex></equ>
&ndash;<equ id="equ255" type="inline">
<tex>
$17$

</tex></equ>
and compared results with those using PLOP. Here the sampling and scoring processes were similar to those usedin Test Set 3 , except 100 , 000  backbone conformations were generated. We measured the average minimum backbone RMSD<equ id="equ256" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
and theaverage RMSD of the lowest energy conformations<equ id="equ257" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
. Ourresults are summarized in Table&nbsp;<tblref rids="tbl7">Table&#146;7</tblref>. </p><p id="para30">Loops predicted by the PLOP method have smaller<equ id="equ258" type="inline">
<tex>
$R_{E_{\min}}$

</tex></equ>
compared to {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&nbsp; <citref rids="ref23">23</citref> , although {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>samples well and gives small<equ id="equ259" type="inline">
<tex>
$R_{\min}$

</tex></equ>
of<equ id="equ260" type="inline">
<tex>
$1.58$

</tex></equ>
rAfor<equ id="equ261" type="inline">
<tex>
$14$

</tex></equ>
&hyphen;residue loops, <equ id="equ262" type="inline">
<tex>
$1.80$

</tex></equ>
rAfor<equ id="equ263" type="inline">
<tex>
$15$

</tex></equ>
&hyphen;residue loops, <equ id="equ264" type="inline">
<tex>
$1.88$

</tex></equ>
rAfor<equ id="equ265" type="inline">
<tex>
$16$

</tex></equ>
&hyphen;residue loops, and<equ id="equ266" type="inline">
<tex>
$2.18$

</tex></equ>
rAfor<equ id="equ267" type="inline">
<tex>
$17$

</tex></equ>
&hyphen;residueloops. For loops of length<equ id="equ268" type="inline">
<tex>
$17$

</tex></equ>
, the<equ id="equ269" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
of<equ id="equ270" type="inline">
<tex>
$2.18$

</tex></equ>
rAis less than the reported<equ id="equ271" type="inline">
<tex>
$R_{Emin}=2.30$

</tex></equ>
rAusingPLOP, although it is unclear whether the<equ id="equ272" type="inline">
<tex>
$R_{\rmmin}$

</tex></equ>
of loops generatedby PLOP is less than<equ id="equ273" type="inline">
<tex>
$2.18$

</tex></equ>
rA. Overall, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>is capableof successfully generating high quality near&hyphen;native long loops, upto length 17 . The accuracy of<equ id="equ274" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
of loops generated by {\sc
DiSGro}
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> may be further improved by using a more effective scoringfunction. </p><p id="para31">We also compared the computational costs of the two methods. Theaverage computing time for {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> is<equ id="equ275" type="inline">
<tex>
$0.73$

</tex></equ>
, <equ id="equ276" type="inline">
<tex>
$0.72$

</tex></equ>
, <equ id="equ277" type="inline">
<tex>
$0.81$

</tex></equ>
, and<equ id="equ278" type="inline">
<tex>
$0.95$

</tex></equ>
hours for loops of lengths<equ id="equ279" type="inline">
<tex>
$14$

</tex></equ>
, <equ id="equ280" type="inline">
<tex>
$15$

</tex></equ>
, <equ id="equ281" type="inline">
<tex>
$16$

</tex></equ>
, and<equ id="equ282" type="inline">
<tex>
$17$

</tex></equ>
using a single core AMD Opteron processor<equ id="equ283" type="inline">
<tex>
$2350$

</tex></equ>
, respectively, which is more than two orders of magnitude less than the timerequired for the PLOP method&lpar;<equ id="equ284" type="inline">
<tex>
$216.0$

</tex></equ>
, <equ id="equ285" type="inline">
<tex>
$309.6$

</tex></equ>
, <equ id="equ286" type="inline">
<tex>
$278.4$

</tex></equ>
, and<equ id="equ287" type="inline">
<tex>
$408.0$

</tex></equ>
hours for loops of length<equ id="equ288" type="inline">
<tex>
$14$

</tex></equ>
, <equ id="equ289" type="inline">
<tex>
$15$

</tex></equ>
, <equ id="equ290" type="inline">
<tex>
$16$

</tex></equ>
, and<equ id="equ291" type="inline">
<tex>
$17$

</tex></equ>
residues, respectively&rpar;. </p></section>
<section level="2" id="section8"><title>Improvement in computing efficiency</title><p id="para32"> We used a REsidue&hyphen;residue Distance Cutoff and ELLipsoid criterion&lpar;R<emph type="smallcaps">edcell</emph>&rpar;to improve the computational efficiency. To assessthe effectiveness of this approach, we carry out a test using a setof 140  proteins&lpar;see discussion of the tuning set in Materials andMethods&rpar;. We compared the time cost of energy calculation ofgenerating a single loop, with and without this procedure. When theprocedure is applied, we only calculate the pairwise atom&hyphen;atomdistance energy between atoms in loop residues and other atomswithin the ellipsoid. When the procedure is not applied, wecalculate energy function between atoms in loop residues and allother atoms in the rest of the protein. The computational cost ofenergy calculations for sampling single loops with<equ id="equ292" type="inline">
<tex>
$12$

</tex></equ>
and<equ id="equ293" type="inline">
<tex>
$6$

</tex></equ>
&hyphen;residues are shown in Figure&nbsp;<figref rids="fig2">Figure&#146;2</figref>A andFigure&nbsp;<figref rids="fig2">Figure&#146;2</figref>B, respectively. </p><p id="para33">From Figure&nbsp;<figref rids="fig2">Figure&#146;2</figref>, we can see that significantimprovement in computational cost is achieved. The average time costusing our procedure is reduced from<equ id="equ294" type="inline">
<tex>
$82.3\:ms$

</tex></equ>
to<equ id="equ295" type="inline">
<tex>
$6.0\:ms$

</tex></equ>
forsampling<equ id="equ296" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops, and<equ id="equ297" type="inline">
<tex>
$39.4\:ms$

</tex></equ>
to<equ id="equ298" type="inline">
<tex>
$2.0\:ms$

</tex></equ>
for<equ id="equ299" type="inline">
<tex>
$6$

</tex></equ>
&hyphen;residue loops. In addition, this approach makes the time cost ofenergy calculations independent of the proteinsize&nbsp;&lpar;Figure&nbsp;<figref rids="fig2">Figure&#146;2</figref>A andFigure&nbsp;<figref rids="fig2">Figure&#146;2</figref>B&rpar;, whereas the computing time withoutapplying this procedure increases linearly with the protein size. The improvement is especially significant for large proteins. Forexample, to generate a<equ id="equ300" type="inline">
<tex>
$6$

</tex></equ>
&hyphen;residue loop in a protein with<equ id="equ301" type="inline">
<tex>
$1,114$

</tex></equ>
residues, the computing time is improved from<equ id="equ302" type="inline">
<tex>
$93.7\:ms$

</tex></equ>
to<equ id="equ303" type="inline">
<tex>
$1.8\:ms$

</tex></equ>
, which is more than<equ id="equ304" type="inline">
<tex>
$50$

</tex></equ>
&hyphen;fold speed&hyphen;up. Detailedexamination indicates that both distance cutoff and the ellipsoidcriterion contribute to the computing efficiency. Furthermore, thefull {\scRedcell}R<emph type="smallcaps">edcell</emph> procedure has improved efficiency over usingeither&ldquo;Ellipsoid Criterion Only&rdquo;or&ldquo;Cutoff Criterion Only&rdquo;. The computing time for generating a<equ id="equ305" type="inline">
<tex>
$6$

</tex></equ>
&hyphen;residue loops is<equ id="equ306" type="inline">
<tex>
$2.0\:ms$

</tex></equ>
when the full {\scRedcell}R<emph type="smallcaps">edcell</emph> procedure is applied, compared to<equ id="equ307" type="inline">
<tex>
$5.3\:ms$

</tex></equ>
, and<equ id="equ308" type="inline">
<tex>
$3.9\:ms$

</tex></equ>
, when only the ellipsoid criterion and onlythe distance&hyphen;threshold are used, respectively&lpar;Figure&nbsp;<figref rids="fig2">Figure&#146;2</figref>C&rpar;. Furthermore, there is no loss ofaccuracy in energy evaluation. Overall, R<emph type="smallcaps">edcell</emph>improves thecomputational cost by excluding many atoms from collision detectionsand energy calculations, with significant reduction in computationtime, especially for large size proteins. </p></section></section>
<section level="1" id="section9"><title>Discussion</title><p id="para34"> In this study, we presented a novel method Distance&hyphen;guidedSequential chain&hyphen;Growth Monte Carlo&lpar;D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&rpar;for generatingprotein loop conformations and predicting loop structures. Highquality ensembles of loops with enriched near&hyphen;native conformationscan be efficiently generated using the {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> method. 
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>has better average minimum backbone RMSD<equ id="equ309" type="inline">
<tex>
$R_{\min}$

</tex></equ>
comparedto other loop sampling methods. For example, <equ id="equ310" type="inline">
<tex>
$R_{\min}$

</tex></equ>
is<equ id="equ311" type="inline">
<tex>
$1.53$

</tex></equ>
rAfor12 &hyphen;residue loops when using {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>, but takes thevalue of<equ id="equ312" type="inline">
<tex>
$3.05$

</tex></equ>
rA, <equ id="equ313" type="inline">
<tex>
$2.34$

</tex></equ>
rA, <equ id="equ314" type="inline">
<tex>
$2.25$

</tex></equ>
rA, and<equ id="equ315" type="inline">
<tex>
$1.81$

</tex></equ>
rAwhen using the CCD, CSJD, SOS, and the FALCm method. </p><p id="para35">D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>also performs well in identifying native&hyphen;likeconformations using atom&hyphen;based distance&hyphen;dependent empiricalpotential function. In comparison with other similar loop modelingmethods, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>demonstrated improved modeling accuracy, withan average RMSD of the lowest energy conformations<equ id="equ316" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
forthe more challenging task of sampling longer loops of<equ id="equ317" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;<equ id="equ318" type="inline">
<tex>
$13$

</tex></equ>
residues. For example, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>outperforms FALCm&nbsp; <citref rids="ref22">22</citref> &lpar;<equ id="equ319" type="inline">
<tex>
$2.33$

</tex></equ>
rA{\itvs}<emph type="italic">vs</emph><equ id="equ320" type="inline">
<tex>
$3.09$

</tex></equ>
rA&rpar;andLOOPER&nbsp; <citref rids="ref17">17</citref> &lpar;<equ id="equ321" type="inline">
<tex>
$2.30$

</tex></equ>
rA<emph type="italic">vs</emph><equ id="equ322" type="inline">
<tex>
$2.66$

</tex></equ>
rA&rpar;inpredicting<equ id="equ323" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops, while taking less computing time&lpar;<equ id="equ324" type="inline">
<tex>
$6$

</tex></equ>
minutes {\itvs}<emph type="italic">vs</emph><equ id="equ325" type="inline">
<tex>
$180$

</tex></equ>
minutes for FALCm and<equ id="equ326" type="inline">
<tex>
$40$

</tex></equ>
minutes forLOOPER. Compared to LoopBuilder&nbsp; <citref rids="ref42">42</citref> , D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>alsohas better<equ id="equ327" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
&colon;For<equ id="equ328" type="inline">
<tex>
$13$

</tex></equ>
&hyphen;residue loops, the<equ id="equ329" type="inline">
<tex>
$R_{Emin}$

</tex></equ>
is<equ id="equ330" type="inline">
<tex>
$3.26$

</tex></equ>
rAusingD<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>, but is<equ id="equ331" type="inline">
<tex>
$3.74$

</tex></equ>
rAwhenusingthe Loop Builder. The average computing time is also faster whenusing {\scDisGRo}D<emph type="smallcaps">is</emph>GR<emph type="smallcaps">o</emph>&colon;it takes about<equ id="equ332" type="inline">
<tex>
$6$

</tex></equ>
minutes to predict structuresof<equ id="equ333" type="inline">
<tex>
$10$

</tex></equ>
&hyphen;residue loops and<equ id="equ334" type="inline">
<tex>
$10$

</tex></equ>
minutes for<equ id="equ335" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residue loops. 
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>also works well for short loops, although this may belargely a reflection of the underlying analytical closuremethod&nbsp; <citref rids="ref12">12</citref> . </p><p id="para36">There are a number of directions for further improvement. 
D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>can be further improved by adding fragments of peptides whengrowing loops instead of adding individual residues. Fragment&hyphen;basedapproach has been widely used in protein structureprediction&nbsp; <citref rids="ref48 ref49 ref50 ref51">48&ndash;51</citref> andspecifically in loop structure prediction&nbsp; <citref rids="ref21">21</citref> . It isstraightforward to apply the strategy described in this study forfragment&hyphen;based growth, and it will likely lead to improved samplingefficiency further and enable longer loops to be modeled. Furthermore, the energy function employed here can be furtherimproved by optimization such as those obtained by training withchallenging decoy loops using nonlinear kernel&nbsp; <citref rids="ref52">52</citref> , and&sol;orusing rapid iterations through a physical convergencefunction&nbsp; <citref rids="ref53 ref54">53,54</citref> . In addition, D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>iscompatible with different loop closuremethods&nbsp; <citref rids="ref8 ref12 ref22">8,12,22</citref> , and experimentingwith other closure strategy may also lead to further improvement. </p><p id="para37">An efficient loop sampling method such as {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> can help toimprove overall modeling of loop structures. Currently, thehierarchical approach of the Protein Local Optimization Program&lpar;PLOP&rpar;&nbsp; <citref rids="ref13 ref14 ref23">13,14,23</citref> gives excellent accuracyin protein loop modeling, but requires significant computationaltime. The average time cost of modeling a<equ id="equ336" type="inline">
<tex>
$13$

</tex></equ>
&hyphen;residue loop is about4&ndash;5  days&nbsp; <citref rids="ref23">23</citref> . Kinematic closure&lpar;KIC&rpar;method can alsomake very accurate predictions of<equ id="equ337" type="inline">
<tex>
$12$

</tex></equ>
&hyphen;residueloops&nbsp; <citref rids="ref21">21</citref> . However, KIC also requires substantialcomputation, with about<equ id="equ338" type="inline">
<tex>
$320$

</tex></equ>
CPU hours on a single<equ id="equ339" type="inline">
<tex>
$2.2\:GHz$

</tex></equ>
Opteron processor for predicting 12 &hyphen;residueloops&nbsp; <citref rids="ref21">21</citref> . As suggested earlier by Spassov etal&nbsp; <citref rids="ref17">17</citref> , an efficient loop modeling method combinedwith energy minimization may overcome the obstacle of highcomputational cost. By generating high quality initial structuresusing {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>, near native conformations of loops can be usedas candidates for further refinement. </p></section>
<section level="1" id="section10"><title>Materials and Methods</title>
<section level="2" id="section11"><title> Protein structures representation</title><p id="para38"> All heavy atoms in the backbone and side chain of a protein loop areexplicitly modeled. The bond lengths<equ id="equ340" type="inline">
<tex>
$b$

</tex></equ>
and angles<equ id="equ341" type="inline">
<tex>
$\theta$

</tex></equ>
aretaken from standard values specific to residue and atomtype&nbsp; <citref rids="ref55">55</citref> . The backbone dihedral angles<equ id="equ342" type="inline">
<tex>
$(\phi,\psi,\omega)$

</tex></equ>
and side chain dihedral angles<equ id="equ343" type="inline">
<tex>
$\chi$

</tex></equ>
constitute all the degrees of freedom&lpar;DOFs&rpar;in our model. </p></section>
<section level="2" id="section12"><title>Distance&hyphen;guided Sequential chain&hyphen;Growth Monte Carlo&lpar;D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&rpar;</title><p id="para39">In order to efficiently generate adequate number of native&hyphen;like loopconformations, we have developed a Distance&hyphen;guided Sequentialchain&hyphen;Growth Monte Carlo&lpar;D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>&rpar;method. </p><p id="para40">Let the loop to be modeled begins at residue<equ id="equ344" type="inline">
<tex>
$t$

</tex></equ>
and ends at residue<equ id="equ345" type="inline">
<tex>
$l$

</tex></equ>
. The sequence of the positions of backbone heavy atoms from<equ id="equ346" type="inline">
<tex>
$C$

</tex></equ>
atom of residue<equ id="equ347" type="inline">
<tex>
$t$

</tex></equ>
to<equ id="equ348" type="inline">
<tex>
$C_\alpha$

</tex></equ>
&lpar;<equ id="equ349" type="inline">
<tex>
$CA$

</tex></equ>
&rpar;atom of residue<equ id="equ350" type="inline">
<tex>
$l$

</tex></equ>
areunknown and need to be generated. We assume that the backbone atomsbefore and after this fragment are known. Coordinates of side chainatoms are also unknown and need to be generated if the coordinatesof the<equ id="equ351" type="inline">
<tex>
$CA$

</tex></equ>
atoms they are attached to are unknown. </p><p id="para41">At each step of the chain growth process, we generate threeconsecutive backbone atoms continuing from the backbone atom sampledat the previous step. At the<equ id="equ352" type="inline">
<tex>
$(i-t)$

</tex></equ>
&hyphen;th growth step&lpar;<equ id="equ353" type="inline">
<tex>
$t\leqi<
l$

</tex></equ>
&rpar;, the three backbone atoms are<equ id="equ354" type="inline">
<tex>
$C$

</tex></equ>
atom of residue<equ id="equ355" type="inline">
<tex>
$i$

</tex></equ>
, <equ id="equ356" type="inline">
<tex>
$N$

</tex></equ>
atomof residue<equ id="equ357" type="inline">
<tex>
$i+1$

</tex></equ>
, and<equ id="equ358" type="inline">
<tex>
$C_\alpha$

</tex></equ>
atom of residue<equ id="equ359" type="inline">
<tex>
$i+1$

</tex></equ>
&nbsp;&lpar;Figure&nbsp;<figref rids="fig3">Figure&#146;3</figref>&rpar;. The coordinates of the threeatoms, <equ id="equ360" type="inline">
<tex>
$C_{i}$

</tex></equ>
, <equ id="equ361" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
and<equ id="equ362" type="inline">
<tex>
$CA_{i+1}$

</tex></equ>
, are denoted as<equ id="equ363" type="inline">
<tex>
$\mathbf{x}_{C,i}$

</tex></equ>
, <equ id="equ364" type="inline">
<tex>
$\mathbf{x}_{N,i+1}$

</tex></equ>
, and<equ id="equ365" type="inline">
<tex>
$\mathbf{x}_{CA,
i+1}$

</tex></equ>
, respectively. The<equ id="equ366" type="inline">
<tex>
$\omega$

</tex></equ>
dihedral angles that determine thecoordinate of<equ id="equ367" type="inline">
<tex>
$C_\alpha$

</tex></equ>
atoms are sampled from a normaldistribution with mean<equ id="equ368" type="inline">
<tex>
$180^{\circ}$

</tex></equ>
and standard deviation<equ id="equ369" type="inline">
<tex>
$4^{\circ}$

</tex></equ>
. In the next section, we describe in detail in samplingof the dihedral angles<equ id="equ370" type="inline">
<tex>
$(\phi,\psi)$

</tex></equ>
, which determine thecoordinates of the<equ id="equ371" type="inline">
<tex>
$C$

</tex></equ>
and the<equ id="equ372" type="inline">
<tex>
$N$

</tex></equ>
atoms. </p>
<section level="3" id="section12"><title>Sampling backbone<equ id="equ373" type="inline">
<tex>
$(\phi,\psi)$

</tex></equ>
 angles</title><p id="para42"> Without loss of generality, we describe the sampling procedure for<equ id="equ374" type="inline">
<tex>
$C_i$

</tex></equ>
and<equ id="equ375" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
atoms at the<equ id="equ376" type="inline">
<tex>
$(i-t)$

</tex></equ>
&hyphen;th growth step. <equ id="equ377" type="inline">
<tex>
$C_i$

</tex></equ>
isgenerated first, followed by<equ id="equ378" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
. Denote the distance between<equ id="equ379" type="inline">
<tex>
$\mathbf{x}_{CA,i}$

</tex></equ>
and<equ id="equ380" type="inline">
<tex>
$\mathbf{x}_{C,l}$

</tex></equ>
as<equ id="equ381" type="inline">
<tex>
$d_{CA_i,C_l}
=|\mathbf{x}_{C,l}-\mathbf{x}_{CA,i}|$

</tex></equ>
, and thedistance between<equ id="equ382" type="inline">
<tex>
$\mathbf{x}_{C,i}$

</tex></equ>
and<equ id="equ383" type="inline">
<tex>
$\mathbf{x}_{C,l}$

</tex></equ>
as<equ id="equ384" type="inline">
<tex>
$d_{C_i,C_l}=|\mathbf{x}_{C,i}-\mathbf{x}_{C,l}|$

</tex></equ>
. Since thebond angle<equ id="equ385" type="inline">
<tex>
$\theta_{C,i}$

</tex></equ>
formed by the<equ id="equ386" type="inline">
<tex>
$N_i-CA_i$

</tex></equ>
and<equ id="equ387" type="inline">
<tex>
$CA_i-C_i$

</tex></equ>
bonds is fixed, and the bond length<equ id="equ388" type="inline">
<tex>
$b_{CA_i,C_i}$

</tex></equ>
is also fixed, <equ id="equ389" type="inline">
<tex>
$C_i$

</tex></equ>
will be located on a circle<equ id="equ390" type="inline">
<tex>
$\mathbf{C_C}$

</tex></equ>
&nbsp;&lpar;Figure&nbsp;<figref rids="fig3">Figure&#146;3</figref>&rpar;&colon;<equ id="equ391" type="inline">
<tex>
\begin{equation}
\label{eqn:circle-C}\mathbf{C_C}=\{\mathbf{x}\in\mathbb{R}^3|
\mbox{suchthat}||\mathbf{x}-\mathbf{x}_{CA,i}||=b_{CA_i,C_i}
\mbox{and}(\mathbf{x}-\mathbf{x}_{CA,i})\cdot
(\mathbf{x}_{CA,i}-\mathbf{x}_{N,i})=\cos\theta_{C,i}\}.
\end{equation}

</tex></equ>
Given a fixed<equ id="equ392" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
, <equ id="equ393" type="inline">
<tex>
$C_i$

</tex></equ>
can be placed on two positions<equ id="equ394" type="inline">
<tex>
$\mathbf{x}_{C,i}$

</tex></equ>
and<equ id="equ395" type="inline">
<tex>
$\mathbf{x}_{C',i}$

</tex></equ>
on circle<equ id="equ396" type="inline">
<tex>
$\mathbf{C_C}$

</tex></equ>
&nbsp;&lpar;Figure&nbsp;<figref rids="fig3">Figure&#146;3</figref>, <equ id="equ397" type="inline">
<tex>
$\mathbf{x}_{C,i}$

</tex></equ>
and<equ id="equ398" type="inline">
<tex>
$\mathbf{x}_{C',i}$

</tex></equ>
are labeled as<equ id="equ399" type="inline">
<tex>
$C_i$

</tex></equ>
and<equ id="equ400" type="inline">
<tex>
$C'_i$

</tex></equ>
, respectively. &rpar;As the probability for placing<equ id="equ401" type="inline">
<tex>
$C_i$

</tex></equ>
on either position is aboutequal based on our analysis, we randomly select one position toplace atom<equ id="equ402" type="inline">
<tex>
$C_i$

</tex></equ>
. </p><p id="para43">In principle, sampling from the empirical distributions of<equ id="equ403" type="inline">
<tex>
$d_{C_i,
C_l}$

</tex></equ>
and mapping back to<equ id="equ404" type="inline">
<tex>
$C_i$

</tex></equ>
should encourage the growth of loopsto connect to the terminal<equ id="equ405" type="inline">
<tex>
$C_l$

</tex></equ>
atom. Further analysis of theempirical distribution of<equ id="equ406" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
given<equ id="equ407" type="inline">
<tex>
$d_{CA_i,C_l}$

</tex></equ>
showsthat<equ id="equ408" type="inline">
<tex>
$d_{CA_i,C_l}$

</tex></equ>
can be very informative for sampling<equ id="equ409" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
in some cases. This lead us to design the sampling of<equ id="equ410" type="inline">
<tex>
$\mathbf{x}_{C_i}$

</tex></equ>
based on the conditional distribution of<equ id="equ411" type="inline">
<tex>
$\pi(d_{C_i,C_l}|d_{CA_i,C_l})$

</tex></equ>
. See below for details. </p><p id="para44">Generating atom<equ id="equ412" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
is similar to generating<equ id="equ413" type="inline">
<tex>
$C_i$

</tex></equ>
, only<equ id="equ414" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
instead of<equ id="equ415" type="inline">
<tex>
$C_i$

</tex></equ>
is placed on a circle<equ id="equ416" type="inline">
<tex>
$\mathbf{C_N}$

</tex></equ>
&colon;<equ id="equ417" type="inline">
<tex>
\begin{equation}
\label{eqn:circle-N}\mathbf{C_N}=\{\mathbf{x}\in\mathbb{R}^3|
\mbox{suchthat}||\mathbf{x}-\mathbf{x}_{C,i}||=
b_{C_i,N_{i+1}}\mbox{and}(\mathbf{x}-\mathbf{x}_{C,i})\cdot
(\mathbf{x}_{C,i}-\mathbf{x}_{CA,i})=\cos\theta_{N,i+1}\},
\end{equation}

</tex></equ>
where<equ id="equ418" type="inline">
<tex>
$b_{C_i,N_{i+1}}$

</tex></equ>
is the bond length between atom<equ id="equ419" type="inline">
<tex>
$C_i$

</tex></equ>
andatom<equ id="equ420" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
, and the distance between<equ id="equ421" type="inline">
<tex>
$\mathbf{x}_{N,i+1}$

</tex></equ>
and<equ id="equ422" type="inline">
<tex>
$\mathbf{x}_{C,l}$

</tex></equ>
is<equ id="equ423" type="inline">
<tex>
$d_{N_{i+1},C_l}=|\mathbf{x}_{N,i+1}-
\mathbf{x}_{C,l}|$

</tex></equ>
. Similarly, atom<equ id="equ424" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
is placed by sampling<equ id="equ425" type="inline">
<tex>
$d_{N_{i+1},\,C_l}$

</tex></equ>
condition on<equ id="equ426" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
from the empiricalconditional density<equ id="equ427" type="inline">
<tex>
$\pi(d_{N_{i+1},C_l}|d_{C_i,C_l})$

</tex></equ>
. We repeatthis process<equ id="equ428" type="inline">
<tex>
$m$

</tex></equ>
times to generate<equ id="equ429" type="inline">
<tex>
$m$

</tex></equ>
trial positions of<equ id="equ430" type="inline">
<tex>
$C_i$

</tex></equ>
, <equ id="equ431" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
, and<equ id="equ432" type="inline">
<tex>
$CA_{i+1}$

</tex></equ>
. </p></section>
<section level="3" id="section13"><title>Sampling<equ id="equ433" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
 and<equ id="equ434" type="inline">
<tex>
$d_{N_{i+1},C_l}$

</tex></equ>
 from conditional distributions</title><p id="para45"> We sample<equ id="equ435" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
from the conditional distribution<equ id="equ436" type="inline">
<tex>
$\pi(d_{C_i,C_l}|d_{CA_i,C_l})$

</tex></equ>
to obtain the location of<equ id="equ437" type="inline">
<tex>
$C_i$

</tex></equ>
atom. We first construct the empirical joint distribution<equ id="equ438" type="inline">
<tex>
$\pi(d_{CA_i,C_l},d_{C_i,C_l})$

</tex></equ>
by collecting<equ id="equ439" type="inline">
<tex>
$(d_{CA_i,C_l},
d_{C_i,C_l})$

</tex></equ>
pairs over all loops in a loop database derived fromthe CulledPDB database&lpar;version 11118 , at 30 &percnt;identity, 2.0rAresolution, and with<equ id="equ440" type="inline">
<tex>
$R=0.25$

</tex></equ>
&rpar;&nbsp; <citref rids="ref56">56</citref> . From the 6 , 521 protein structures in the CulledPDB, we remove<equ id="equ441" type="inline">
<tex>
$7$

</tex></equ>
PDB structureswhich appear in our test data set. For the rest of<equ id="equ442" type="inline">
<tex>
$6,514$

</tex></equ>
proteinstructures, loop regions were identified using the secondarystructure information either directly from the PDB records or fromclassification provided by the DSSP software&nbsp; <citref rids="ref57">57</citref> . Allrandom coil regions, including<equ id="equ443" type="inline">
<tex>
$\alpha$

</tex></equ>
&hyphen;helices and<equ id="equ444" type="inline">
<tex>
$\beta$

</tex></equ>
&hyphen;strandswith length<equ id="equ445" type="inline">
<tex>
$<4$

</tex></equ>
amino acids, are included in our database. Intotal, we have<equ id="equ446" type="inline">
<tex>
$49,336$

</tex></equ>
loop structures. </p><p id="para46">For each set of loops with the same residue separation<equ id="equ447" type="inline">
<tex>
$(l-i)$

</tex></equ>
, <equ id="equ448" type="inline">
<tex>
$(d_{CA_i,C_l},d_{C_i,C_l})$

</tex></equ>
are Winsorised at<equ id="equ449" type="inline">
<tex>
$99.9\%$

</tex></equ>
level&nbsp; <citref rids="ref58">58</citref> . Specifically, the extreme values above<equ id="equ450" type="inline">
<tex>
$99.9\%$

</tex></equ>
are replaced by the values at the<equ id="equ451" type="inline">
<tex>
$99.9$

</tex></equ>
percentile. Wethen use a nonparametric two&hyphen;dimensional Gaussian kernel densityestimator to construct a smooth bivariate distribution<equ id="equ452" type="inline">
<tex>
$\pi(d_{CA_i,C_l},d_{C_i,C_l})$

</tex></equ>
based on collected data. Toestimate the probability density at a point<equ id="equ453" type="inline">
<tex>
$\mathbf{u}=
(d_{CA_i,C_l},d_{C_i,C_l})\in\mathbb{R}^2$

</tex></equ>
, we use the observed<equ id="equ454" type="inline">
<tex>
$n$

</tex></equ>
pairs of data from the database<equ id="equ455" type="inline">
<tex>
$(\mathbf{x}_{1},\cdots
\mathbf{x}_{n})=((d_{CA_i,C_l,1},d_{C_i,C_l,1}),\cdots
(d_{CA_i,C_l,n},d_{C_i,C_l,n}))$

</tex></equ>
to derive the density function<equ id="equ456" type="inline">
<tex>
$\pi(\mathbf{u})$

</tex></equ>
, which takes the form of&colon;<equ id="equ457" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}\pi(\mathbf{u})=\frac{1}{n}\sum
\limits_{i=1}^n
|\mathbf{H}|^{-\frac{1}{2}}\mathbf{K}
[\mathbf{H}^{-\frac{1}{2}}\cdot(\mathbf{u}-\mathbf{x}_{i})],\\
\end{aligned}\right.
\end{equation}

</tex></equ>
where<equ id="equ458" type="inline">
<tex>
$\mathbf{H}$

</tex></equ>
is the symmetric and positive definite bandwidth<equ id="equ459" type="inline">
<tex>
$2\times2$

</tex></equ>
matrix, <equ id="equ460" type="inline">
<tex>
$\mathbf{K}$

</tex></equ>
is a bivariate gaussian kernelfunction&colon;<equ id="equ461" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}\mathbf{K}(x)=
\frac{e^{(-\frac{1}{2}x^{T}x)}}{2\pi}.
\end{aligned}\right.
\end{equation}

</tex></equ>
</p><p id="para47">To construct the bandwidth matrix<equ id="equ462" type="inline">
<tex>
$\mathbf{H}$

</tex></equ>
, we calculate thestandard deviation<equ id="equ463" type="inline">
<tex>
$\sigma_{d_{CA_i,C_l}}$

</tex></equ>
of the<equ id="equ464" type="inline">
<tex>
$n$

</tex></equ>
pairs of<equ id="equ465" type="inline">
<tex>
$(d_{CA_i,\,C_l},d_{C_i,\,C_l})$

</tex></equ>
. The corresponding entry<equ id="equ466" type="inline">
<tex>
$h_{d_{CA_i,C_l}}$

</tex></equ>
in the bandwidth matrix<equ id="equ467" type="inline">
<tex>
$\mathbf{H}$

</tex></equ>
is set as<equ id="equ468" type="inline">
<tex>
$h_{d_{CA_i,C_l}}=
\sigma_{d_{CA_i,C_l}}(\frac{1}{n})^{\frac{1}{6}}$

</tex></equ>
. Similarly, <equ id="equ469" type="inline">
<tex>
$h_{d_{C_i,C_l}}$

</tex></equ>
is set as<equ id="equ470" type="inline">
<tex>
$h_{d_{C_i,C_l}}=
\sigma_{d_{C_i,C_l}}(\frac{1}{n})^{\frac{1}{6}}$

</tex></equ>
. The bandwidthmatrix<equ id="equ471" type="inline">
<tex>
$\mathbf{H}$

</tex></equ>
is then assembled as&nbsp; <citref rids="ref59">59</citref> &colon;<equ id="equ472" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}\mathbf{H}=\begin{pmatrix}
h_{d_{CA_i,C_l}}&h_{d_{C_i,C_l}}\\
h_{d_{C_i,C_l}}&h_{d_{CA_i,C_l}}\\
\end{pmatrix}.\\
\end{aligned}\right.
\end{equation}

</tex></equ>
We partition the domain of<equ id="equ473" type="inline">
<tex>
$(d_{CA_i,C_l},\,d_{C_i,C_l})$

</tex></equ>
into agrid with 32  grid points in each direction. <equ id="equ474" type="inline">
<tex>
$\pi(d_{CA_i,C_l},
d_{C_i,C_l})$

</tex></equ>
are estimated at the grid points, and interpolated bya bilinear function elsewhere. Conditional distribution<equ id="equ475" type="inline">
<tex>
$\pi(d_{C_i,C_l}|d_{CA_i,C_l})$

</tex></equ>
is constructed from the jointdistribution<equ id="equ476" type="inline">
<tex>
$\pi(d_{CA_i,C_l},\,d_{C_i,C_l})$

</tex></equ>
when<equ id="equ477" type="inline">
<tex>
$d_{CA_i,C_l}$

</tex></equ>
is fixed. <equ id="equ478" type="inline">
<tex>
$d_{C_i,C_l}$

</tex></equ>
is sampled from<equ id="equ479" type="inline">
<tex>
$\pi(d_{C_i,C_l}|
d_{CA_i,C_l})$

</tex></equ>
. We follow the same procedure to construct<equ id="equ480" type="inline">
<tex>
$\pi(d_{N_{i+1},C_l}|d_{C_i,C_l})$

</tex></equ>
, which is used to sample<equ id="equ481" type="inline">
<tex>
$d_{N_{i+1},C_l}$

</tex></equ>
. </p></section>
<section level="3" id="section14"><title>Backbone dihedral angle distributions from the loop database</title><p id="para48"> Although the empirical conditional distributions can efficientlyguide chain growth to generate properly connected loopconformations, the dihedral angles of the loops are often notenergetically favorable. As a result, conditional distributionsdescribed above alone are not sufficient in generating near nativeloop conformations. </p><p id="para49">The problem can be alleviated by an additional step of selecting asubset of<equ id="equ482" type="inline">
<tex>
$n$

</tex></equ>
loops with low&hyphen;energy dihedral angles from generatedsamples. We use empirical distributions of the loop dihedral anglesobtained from the loop database. Specifically, for the<equ id="equ483" type="inline">
<tex>
$m$

</tex></equ>
sampledpositions of the current residue<equ id="equ484" type="inline">
<tex>
$i$

</tex></equ>
of type<equ id="equ485" type="inline">
<tex>
$\alpha_{i}$

</tex></equ>
withdihedral angles<equ id="equ486" type="inline">
<tex>
$(\phi^{1},\psi^{1}),..(\phi^{m},\psi^{m})$

</tex></equ>
, weselect<equ id="equ487" type="inline">
<tex>
$n<m$

</tex></equ>
samples following an empirically derived backbonedihedral angle distribution<equ id="equ488" type="inline">
<tex>
$\pi(\phi_i,\psi_i,\alpha_{i})$

</tex></equ>
. Here<equ id="equ489" type="inline">
<tex>
$\pi(\phi_i,\psi_i,\alpha_{i})$

</tex></equ>
is derived from the same proteinloop structure database for conditional distance distributions andconstructed by counting the frequencies of<equ id="equ490" type="inline">
<tex>
$(\phi,\,\psi)$

</tex></equ>
pairsfor each residue type. </p></section>
<section level="3" id="section15"><title>Determining the number of trial states at each growth step for backbone torsion angles</title><p id="para50"> It is important to determine the appropriate size of trial states<equ id="equ491" type="inline">
<tex>
$m$

</tex></equ>
and<equ id="equ492" type="inline">
<tex>
$n$

</tex></equ>
for generating backbone conformations, as small<equ id="equ493" type="inline">
<tex>
$m$

</tex></equ>
and<equ id="equ494" type="inline">
<tex>
$n$

</tex></equ>
values may lead to insufficient sampling, resulting ininaccurate loop conformations. On the other hand, very large<equ id="equ495" type="inline">
<tex>
$m$

</tex></equ>
and<equ id="equ496" type="inline">
<tex>
$n$

</tex></equ>
values will require significantly more computational time, without significant gain in accuracy. </p><p id="para51">We use a data set, denoted as {\ittuning-set}<emph type="italic">tuning&hyphen;set</emph>to determine theoptimal values of parameters<equ id="equ497" type="inline">
<tex>
$m$

</tex></equ>
and<equ id="equ498" type="inline">
<tex>
$n$

</tex></equ>
for sampling backboneconformations. Part of this data set comes from that of Soto {\itet
al}<emph type="italic">etal</emph>&nbsp; <citref rids="ref42">42</citref> . The rest are randomly selected frompre&hyphen;compiled CulledPDB&lpar;with<equ id="equ499" type="inline">
<tex>
$\le20\%$

</tex></equ>
sequence identity, <equ id="equ500" type="inline">
<tex>
$\le1.8$

</tex></equ>
rAresolution, and<equ id="equ501" type="inline">
<tex>
$R\le0.25$

</tex></equ>
&rpar;. It contains a total of<equ id="equ502" type="inline">
<tex>
$140$

</tex></equ>
loops, with<equ id="equ503" type="inline">
<tex>
$35$

</tex></equ>
loops of length 6 , <equ id="equ504" type="inline">
<tex>
$35$

</tex></equ>
of length 8 , <equ id="equ505" type="inline">
<tex>
$35$

</tex></equ>
of length10 , and<equ id="equ506" type="inline">
<tex>
$35$

</tex></equ>
of length 12 . </p><p id="para52">The optimal values of<equ id="equ507" type="inline">
<tex>
$m$

</tex></equ>
and<equ id="equ508" type="inline">
<tex>
$n$

</tex></equ>
are determined as<equ id="equ509" type="inline">
<tex>
$(m=160,n=
32)$

</tex></equ>
according to the test result on tuning&hyphen;set&lpar;Figure&nbsp;<figref rids="fig4">Figure&#146;4</figref>&rpar;. </p></section>
<section level="3" id="section16"><title>Placement of backbone atoms</title><p id="para53"> From the<equ id="equ510" type="inline">
<tex>
$n$

</tex></equ>
sampled dihedral angle pairs<equ id="equ511" type="inline">
<tex>
$(\phi^{1},\psi^{1}),
\cdots,(\phi^{n},\psi^{n})$

</tex></equ>
, we can calculate the coordinates ofatom<equ id="equ512" type="inline">
<tex>
$C_i$

</tex></equ>
and<equ id="equ513" type="inline">
<tex>
$N_{i+1}$

</tex></equ>
for all of the<equ id="equ514" type="inline">
<tex>
$n$

</tex></equ>
trials. <equ id="equ515" type="inline">
<tex>
$CA_{i+1}$

</tex></equ>
atomsare sampled by generating random<equ id="equ516" type="inline">
<tex>
$\omega$

</tex></equ>
dihedral angles from anormal distribution with mean<equ id="equ517" type="inline">
<tex>
$180^{\circ}$

</tex></equ>
and standard deviationof<equ id="equ518" type="inline">
<tex>
$4^{\circ}$

</tex></equ>
. Calculating the coordinates of backbone<equ id="equ519" type="inline">
<tex>
$O$

</tex></equ>
atomsusing standard bond length and angle values is straightforward. </p><p id="para54">The coordinates of backbone atoms of the<equ id="equ520" type="inline">
<tex>
$n$

</tex></equ>
samples at thisparticular growth step can be denoted as<equ id="equ521" type="inline">
<tex>
$(\mathbf{x}^{1}_{C_i},
\mathbf{x}^{1}_{O_{i}},\mathbf{x}^{1}_{N_{i+1}},
\mathbf{x}^{1}_{CA_{i+1}},\cdots,\mathbf{x}^{k}_{C_i},
\mathbf{x}^{k}_{O_{i}},\mathbf{x}^{k}_{N_{i+1}},
\mathbf{x}^{k}_{CA_{i+1}},\cdots,\mathbf{x}^{n}_{C_i},
\mathbf{x}^{n}_{O_{i}},\mathbf{x}^{n}_{N_{i+1}},
\mathbf{x}^{n}_{CA_{i+1}},)$

</tex></equ>
. For simplicity, we denote thecoordinates of the four atoms at residue<equ id="equ522" type="inline">
<tex>
$i$

</tex></equ>
as<equ id="equ523" type="inline">
<tex>
$S_i$

</tex></equ>
and the<equ id="equ524" type="inline">
<tex>
$k$

</tex></equ>
&hyphen;thsample as<equ id="equ525" type="inline">
<tex>
$S^k_i$

</tex></equ>
. We sample one of them using an energy criterion. The probability for<equ id="equ526" type="inline">
<tex>
$S^k_i$

</tex></equ>
is defined by<equ id="equ527" type="inline">
<tex>
$$
\pi_(S^k_i|S_t,S_{t+1},\cdots,S_{i-1})\sim\exp({-E(S^k_i)}/T),
$$

</tex></equ>
where<equ id="equ528" type="inline">
<tex>
$T=1$

</tex></equ>
is the effective temperature, and<equ id="equ529" type="inline">
<tex>
$E(S^k_i)$

</tex></equ>
isthe interaction energy of the four atoms defined by<equ id="equ530" type="inline">
<tex>
$S^k_i$

</tex></equ>
with theremaining part of the protein, including those loop atoms sampled inprevious steps. The energy function<equ id="equ531" type="inline">
<tex>
$E$

</tex></equ>
is an atomicdistance&hyphen;dependent empirical potential function constructed from theloop database, which is effective in detecting steric clashes andefficient to compute. Fragments with steric clashes are rarely drawnbecause of their high energy values. In summary, the coordinates ofthe four backbone atoms, <equ id="equ532" type="inline">
<tex>
$S_i=(C_i,O_i,N_{i+1},CA_{i+1})$

</tex></equ>
, isdrawn from the following joint distribution at this step&colon;</p><equ id="equ533" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}
S_i\sim\pi(d_{C_i,C_l}|d_{CA_i,C_l})\cdot\pi(d_{N_{i+1},C_l}|d_{C_i,C_l})\cdot\pi(\omega)\cdot\pi(\phi^{i},\psi^{i},\alpha_{i})\cdot\pi(S_i|S_t,S_{t+1},\cdots,S_{i-1})
.
\end{aligned}\right.
\end{equation}

</tex></equ>
<p id="para55">Altogether, &lpar;<equ id="equ534" type="inline">
<tex>
$l-t)$

</tex></equ>
backbone dihedral angle combinations need to besampled. When the growing end is three residues away from the<equ id="equ535" type="inline">
<tex>
$C$

</tex></equ>
&hyphen;terminal anchor atom of the loop, <equ id="equ536" type="inline">
<tex>
$C_l$

</tex></equ>
, we apply the CSJDanalytical closure method to generate coordinates of the remainingbackbone atoms&nbsp; <citref rids="ref12">12</citref> . Small fluctuations of bondlengths, angles, and<equ id="equ537" type="inline">
<tex>
$\omega$

</tex></equ>
dihedral angles are introduced to theanalytical closure method to increase the success rate of loopclosure. </p></section>
<section level="2" id="section18"><title>Improving computing efficiency</title><p id="para56"> To reduce computational cost of calculating atom&hyphen;atom distances inenergy evaluation, we use a procedure, REsidue&hyphen;residue DistanceCutoff and ELLipsoid criterion&lpar;R<emph type="smallcaps">edcell</emph>&rpar;to reduce the amountof computational time. </p></section>
<section level="3" id="section18"><title>Residue&hyphen;residue distance cutoff</title><p id="para57"> The residue&hyphen;residue distance cutoff<equ id="equ538" type="inline">
<tex>
$d_{R}$

</tex></equ>
is used to excluderesidues far from the loop energy calculation. Instead of auniversal cutoff value, such as the<equ id="equ539" type="inline">
<tex>
$10$

</tex></equ>
rA<equ id="equ540" type="inline">
<tex>
$C_{\beta}-
C_{\beta}$

</tex></equ>
distance used in reference&nbsp; <citref rids="ref51">51</citref> , we use aresidue&hyphen;dependent distance cutoff value. The residue&hyphen;residuedistance cutoff<equ id="equ541" type="inline">
<tex>
$d_R$

</tex></equ>
is assigned to be<equ id="equ542" type="inline">
<tex>
$r_{i}+r_{j}+c$

</tex></equ>
, where<equ id="equ543" type="inline">
<tex>
$r_i$

</tex></equ>
and<equ id="equ544" type="inline">
<tex>
$r_j$

</tex></equ>
are the effective radii of residue<equ id="equ545" type="inline">
<tex>
$i$

</tex></equ>
and<equ id="equ546" type="inline">
<tex>
$j$

</tex></equ>
, respectively. For one residue type, effective radii is the distancebetween residue geometrical center and the heavy atom which isfarthest away from the residue geometrical center. <equ id="equ547" type="inline">
<tex>
$c$

</tex></equ>
is a constantset to<equ id="equ548" type="inline">
<tex>
$8$

</tex></equ>
rA. For a residue<equ id="equ549" type="inline">
<tex>
$i$

</tex></equ>
in the loop region and residue<equ id="equ550" type="inline">
<tex>
$j$

</tex></equ>
in the non&hyphen;loop region, we calculate the residue&hyphen;residuedistance<equ id="equ551" type="inline">
<tex>
$d_{ij}=\|\mathbf{x}_i-\mathbf{x}_j\|$

</tex></equ>
, where<equ id="equ552" type="inline">
<tex>
$\mathbf{x}_i$

</tex></equ>
and<equ id="equ553" type="inline">
<tex>
$\mathbf{x}_j$

</tex></equ>
are the geometric centers ofresidue<equ id="equ554" type="inline">
<tex>
$i$

</tex></equ>
and<equ id="equ555" type="inline">
<tex>
$j$

</tex></equ>
, respectively. If<equ id="equ556" type="inline">
<tex>
$d_{ij}>d_R$

</tex></equ>
, all of theatoms in residue<equ id="equ557" type="inline">
<tex>
$j$

</tex></equ>
are excluded from energy calculation. Thisresidue&hyphen;dependent cutoff is more accurate and ensures close residuesare included. </p></section>
<section level="3" id="section19"><title>Ellipsoid criterion</title><p id="para58"> The basic idea of ellipsoid criterion is to construct a symmetricellipsoid such that all atoms that need to be considered for energycalculation during loop sampling are enclosed in the ellipsoid. Atoms that are outside of the ellipsoid can then be safely excluded. The starting and ending residues of a loop naturally serve as thetwo focal points of the ellipsoid. Intuitively, all backbone atomsof a loop must be within an ellipsoid. Formally, we define a set ofpoints<equ id="equ558" type="inline">
<tex>
$\{\mathbf{x}\}$

</tex></equ>
, the sum of whose distances to the two fociis less than<equ id="equ559" type="inline">
<tex>
$L$

</tex></equ>
, defined as the sum of the backbone bond lengths<equ id="equ560" type="inline">
<tex>
$b_{C-C}$

</tex></equ>
of the loop of length<equ id="equ561" type="inline">
<tex>
$l$

</tex></equ>
&colon;<equ id="equ562" type="inline">
<tex>
$$
\{\mathbf{x}=({\itx_1},{\itx_2},{\itx_3})\in\mathbb{R}^3|
\;\|\mathbf{x}-\mathbf{x}_1\|+\|\mathbf{x}-\mathbf{x}_2\|\le
L\},
$$

</tex></equ>
<equ id="equ563" type="inline">
<tex>
$$
L=2a=\sum\limits^lb_{C-C},
$$

</tex></equ>
where<equ id="equ564" type="inline">
<tex>
$\mathbf{x}_1$

</tex></equ>
and<equ id="equ565" type="inline">
<tex>
$\mathbf{x}_2$

</tex></equ>
are the two focal points ofthe ellipsoid. The symmetric ellipsoid&lpar;<equ id="equ566" type="inline">
<tex>
$b=c$

</tex></equ>
&rpar;can be written as&colon;<equ id="equ567" type="inline">
<tex>
\begin{equation}
\label{eqn:ellipsoid}
\left.\begin{aligned}
\frac{{\itx_1}^2}{a^2}+\frac{{\itx_2}^2}{b^2}+\frac{{\itx_3}^2}{b^2}=1,
\end{aligned}\right.
\end{equation}

</tex></equ>
where<equ id="equ568" type="inline">
<tex>
$a=L/2$

</tex></equ>
and<equ id="equ569" type="inline">
<tex>
$b=[(L/2)^2-(\frac{||\mathbf{x}_1-
\mathbf{x}_2||}{2})^2]^{1/2}$

</tex></equ>
correspond to the semi&hyphen;major axis andsemi&hyphen;minor axis of the symmetric ellipsoid, respectively. Toincorporate the effects of side chain atoms, we enlarge theellipsoid by the amount of the maximum side&hyphen;chain length<equ id="equ570" type="inline">
<tex>
$s$

</tex></equ>
. Furthermore, we assume that any atom can interact with a loop atomif it is within a distance cut&hyphen;off of<equ id="equ571" type="inline">
<tex>
$k$

</tex></equ>
. As a result, the overallenlargement of the ellipsoid is<equ id="equ572" type="inline">
<tex>
$(s+k)$

</tex></equ>
. The final definition ofthe enlarged ellipsoid for detecting possible atom&hyphen;atom interactionsis given by Eqn&nbsp;&lpar;&rpar;, with<equ id="equ573" type="inline">
<tex>
\begin{equation}
a=(||\mathbf{x}_1-\mathbf{x}_2||/2)\sec\alpha_2,
\label{eqn:ellipa}
\end{equation}

</tex></equ>
and<equ id="equ574" type="inline">
<tex>
\begin{equation}
b=(||\mathbf{x}_1-\mathbf{x}_2||/2)\tan\alpha_1+s+k,
\label{eqn:ellipb}
\end{equation}

</tex></equ>
where<equ id="equ575" type="inline">
<tex>
$\alpha_1$

</tex></equ>
is determined by the equation<equ id="equ576" type="inline">
<tex>
$\sec\alpha_1=
\frac{L}{||\mathbf{x}_1-\mathbf{x}_2||}$

</tex></equ>
, and<equ id="equ577" type="inline">
<tex>
$\alpha_2$

</tex></equ>
by<equ id="equ578" type="inline">
<tex>
$\tan
\alpha_2=\frac{(s+k)+(||\mathbf{x}_1-\mathbf{x}_2||/2)\tan
\alpha_1}{||\mathbf{x}_1-\mathbf{x}_2||/2}$

</tex></equ>
&lpar;see Figure&nbsp;<figref rids="fig5">Figure&#146;5</figref>B&rpar;. </p><p id="para59">For any atom in the protein, if the sum of its distances to the twofoci points is greater than<equ id="equ579" type="inline">
<tex>
$2a$

</tex></equ>
, this atom is permanently excludedfrom energy calculations. The computational cost to enforce thiscriterion depends only on the loop length and is independent of thesize the protein, once the rest of the residues have been examinedusing the ellipsoid criterion. This improves our computingefficiency significantly, especially for large proteins. Thiscriterion also helps to prune chain growth by terminating a growthattempt if the placed atoms are outside the ellipsoid. </p></section>
<section level="2" id="section21"><title>Side&hyphen;chain modeling and steric clash removal</title><p id="para60"> Side chains are built upon completion of backbone sampling of aloop. For the<equ id="equ580" type="inline">
<tex>
$i$

</tex></equ>
&hyphen;th residue of type<equ id="equ581" type="inline">
<tex>
$a_i$

</tex></equ>
, we denote the degrees offreedom&lpar;DOFs&rpar;for its side chain as<equ id="equ582" type="inline">
<tex>
$s_{(a_i)}$

</tex></equ>
. DOFs of side chainresidues depend on the residue types, <emph type="italic">e. g. </emph>Arg has fourdihedral angles&lpar;<equ id="equ583" type="inline">
<tex>
$\chi_{1},\chi_{2},\chi_{3},\chi_{4}$

</tex></equ>
&rpar;, with&lpar;<equ id="equ584" type="inline">
<tex>
$s_{(ARG)}=4$

</tex></equ>
&rpar;. Val only has one dihedral angle&lpar;<equ id="equ585" type="inline">
<tex>
$\chi_{1}$

</tex></equ>
&rpar;, with&lpar;<equ id="equ586" type="inline">
<tex>
$s_{(VAL)}=1$

</tex></equ>
&rpar;. Each DOFs is discretized into bins of<equ id="equ587" type="inline">
<tex>
$4^{\circ}$

</tex></equ>
, and only bins with non&hyphen;zero entries for all loopresidues in the loop database are retained. </p><p id="para61">We sample<equ id="equ588" type="inline">
<tex>
$n_{sc}$

</tex></equ>
trial states of side chains from the empiricaldistribution<equ id="equ589" type="inline">
<tex>
$\pi(\chi_{1}\cdots\chi_{s_{(a_i)}})$

</tex></equ>
obtained fromthe loop database. One of<equ id="equ590" type="inline">
<tex>
$n_{sc}$

</tex></equ>
trials is then chosen accordingto the probability calculated by the empirical potential. Denote theside chain fragment for the<equ id="equ591" type="inline">
<tex>
$i$

</tex></equ>
&hyphen;th residue as<equ id="equ592" type="inline">
<tex>
$\mathbf{z}_i$

</tex></equ>
, weselect<equ id="equ593" type="inline">
<tex>
$\mathbf{z}_{i}$

</tex></equ>
following the probability distribution&colon;<equ id="equ594" type="inline">
<tex>
$$
\pi_{i}(\mathbf{z}_{i})\sim\exp({-E(\mathbf{z}_{i})}/T),
$$

</tex></equ>
where<equ id="equ595" type="inline">
<tex>
$E(\mathbf{z}_{i})$

</tex></equ>
is the interaction energy of the newly addedside chain fragment<equ id="equ596" type="inline">
<tex>
$\mathbf{z}_{i}$

</tex></equ>
with the remaining part of theprotein, and<equ id="equ597" type="inline">
<tex>
$T$

</tex></equ>
is the effective temperature. </p><p id="para62">When there are steric clashes between side chains, we rotate theside&hyphen;chain atoms along the<equ id="equ598" type="inline">
<tex>
$\mathrm{C_{\alpha}}-C_{\beta}$

</tex></equ>
axis forall residue types except Pro. For Pro, we use the<equ id="equ599" type="inline">
<tex>
$N-\mathrm{C_{\alpha}}$

</tex></equ>
axis for rotation. We consider two atoms tobe in steric clash if the ratio of their distance to the sum oftheir van der Waals radii is less than<equ id="equ600" type="inline">
<tex>
$0.65$

</tex></equ>
&nbsp; <citref rids="ref13">13</citref> . </p></section>
<section level="2" id="section22"><title>Potential function</title><p id="para63"> To evaluate the energy of loops, we developed a simple atom&hyphen;baseddistance&hyphen;dependent empirical potential function, followingwell&hyphen;establishedpractices&nbsp; <citref rids="ref46 ref52 ref60 ref61 ref62 ref63 ref64 ref65 ref66">46,52,60&ndash;66</citref> . Empirical energy functions developed from databases have been shownto be very effective in protein structure prediction, decoydiscrimination, and protein&hyphen;ligandinteractions&nbsp; <citref rids="ref54 ref63 ref64 ref67 ref68 ref69 ref70 ref71">54,63,64,67&ndash;71</citref> . As our interest is modeling the loop regions, the atomicdistance&hyphen;dependent empirical potential is built from loop structurescollected in the PDB&nbsp; <citref rids="ref72">72</citref> . </p><p id="para64">Instead of using detailed<equ id="equ601" type="inline">
<tex>
$167$

</tex></equ>
atom types associated with the<equ id="equ602" type="inline">
<tex>
$20$

</tex></equ>
amino acids, we group all heavy atoms into<equ id="equ603" type="inline">
<tex>
$20$

</tex></equ>
groups, similar tothe approach used in Rosetta&nbsp; <citref rids="ref50">50</citref> . The<equ id="equ604" type="inline">
<tex>
$16$

</tex></equ>
side&hyphen;chain atom types comprise six carbon types, six nitrogen types, three oxygen types, and one sulfur type. The<equ id="equ605" type="inline">
<tex>
$4$

</tex></equ>
backbone types areN, <equ id="equ606" type="inline">
<tex>
$\mathrm{C_{\alpha}}$

</tex></equ>
, C, and O. This simplified scheme helps toalleviate the problem of sparsity of observed data for certainparameter values. For an atom<equ id="equ607" type="inline">
<tex>
$i$

</tex></equ>
in the loop region of atom type<equ id="equ608" type="inline">
<tex>
$a_{i}$

</tex></equ>
and an atom<equ id="equ609" type="inline">
<tex>
$j$

</tex></equ>
of atom type<equ id="equ610" type="inline">
<tex>
$a_{j}$

</tex></equ>
, regardless whether<equ id="equ611" type="inline">
<tex>
$j$

</tex></equ>
is in the loop region, the distance&hyphen;dependent interaction energy<equ id="equ612" type="inline">
<tex>
$E_{(a_{i},a_{j};\:d_{ij})}$

</tex></equ>
is calculated as&colon;<equ id="equ613" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}
E_{(a_{i},a_{j};\:d_{ij})}&=
-\ln\frac{\pi(a_{i},a_{j};\:d_{ij})}{\pi^{\prime}(a_{i},a_{j};\:d_{ij})},\\
\end{aligned}\right.
\end{equation}

</tex></equ>
</p><p id="para65">where<equ id="equ614" type="inline">
<tex>
$E_(a_{i},a_{j};\:d_{ij})$

</tex></equ>
denotes the interaction energybetween a specific atom pair<equ id="equ615" type="inline">
<tex>
$(a_{i},a_{j})$

</tex></equ>
at distance<equ id="equ616" type="inline">
<tex>
$d_{ij}$

</tex></equ>
, <equ id="equ617" type="inline">
<tex>
$\pi(a_{i},a_{j};\:d_{ij})$

</tex></equ>
and<equ id="equ618" type="inline">
<tex>
$\pi^{\prime}(a_{i},a_{j};\:d_{ij})$

</tex></equ>
are the observed probability of this distance&hyphen;dependent interactionfrom the loop database and the expected probability from a randommodel, respectively. </p><p id="para66">The observed probability<equ id="equ619" type="inline">
<tex>
$\pi(a_{i},a_{j};\:d_{ij})$

</tex></equ>
is calculatedas&colon;<equ id="equ620" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}
\pi(a_{i},a_{j};\:d_{ij})=
\frac{n(a_{i},a_{j};\:d_{ij})}{n_{total}},
\end{aligned}\right.
\end{equation}

</tex></equ>
</p><p id="para67">where<equ id="equ621" type="inline">
<tex>
$n(a_{i},a_{j};\:d_{ij})$

</tex></equ>
is the observed count of<equ id="equ622" type="inline">
<tex>
$(a_i,
a_j)$

</tex></equ>
pairs found in the loop structures with the distance<equ id="equ623" type="inline">
<tex>
$d_{ij}$

</tex></equ>
falling in the predefined bins. We use a total of<equ id="equ624" type="inline">
<tex>
$60$

</tex></equ>
bins for<equ id="equ625" type="inline">
<tex>
$d_{ij}$

</tex></equ>
, ranging from<equ id="equ626" type="inline">
<tex>
$2$

</tex></equ>
rAto<equ id="equ627" type="inline">
<tex>
$8$

</tex></equ>
rA, with the bin widthset to<equ id="equ628" type="inline">
<tex>
$0.1$

</tex></equ>
rA. <equ id="equ629" type="inline">
<tex>
$d_{ij}$

</tex></equ>
ranging from<equ id="equ630" type="inline">
<tex>
$0$

</tex></equ>
rAto<equ id="equ631" type="inline">
<tex>
$2$

</tex></equ>
rAis treated as one bin. Here<equ id="equ632" type="inline">
<tex>
$n(a_{i},a_{j};\:d_{ij})=
\sum\limits_{k=1}^{N}n(a_{i},a_{j},\:d_{ij}(k))$

</tex></equ>
, where<equ id="equ633" type="inline">
<tex>
$N$

</tex></equ>
is thenumber of loops in our loop database, <equ id="equ634" type="inline">
<tex>
$n(a_{i},a_{j},\:d_{ij}(k))$

</tex></equ>
is the observed number of<equ id="equ635" type="inline">
<tex>
$(a_i,a_j)$

</tex></equ>
pairs at the distance of<equ id="equ636" type="inline">
<tex>
$d_{ij}$

</tex></equ>
in the<equ id="equ637" type="inline">
<tex>
$k$

</tex></equ>
&hyphen;th loop. <equ id="equ638" type="inline">
<tex>
$n_{total}$

</tex></equ>
is the observed totalnumber of all atom pairs in the loop database regardless of the atomtypes and distance, namely, <equ id="equ639" type="inline">
<tex>
$n_{total}=\sum\limits_{d_{ij}}
\sum\limits_{a_{j}}\sum\limits_{a_{i}}n(a_{i},a_{j};\:d_{ij})$

</tex></equ>
. </p><p id="para68">The expected random distance&hyphen;dependent probability of this pair<equ id="equ640" type="inline">
<tex>
$\pi^{\prime}(a_{i},a_{j};\:d_{ij})$

</tex></equ>
is calculated based on sampledloop conformations, called decoys. It is calculated as&colon;<equ id="equ641" type="inline">
<tex>
\begin{equation}
\left.\begin{aligned}
\pi^{\prime}(a_{i},a_{j};\:d_{ij})=
\frac{n^{\prime}(a_{i},a_{j};\:d_{ij})}{n^{\prime}_{total}},
\end{aligned}\right.
\end{equation}

</tex></equ>
</p><p id="para69">where<equ id="equ642" type="inline">
<tex>
$n^{\prime}(a_{i},a_{j};\:d_{ij})=\sum\limits_{k=1}^{N}
(\frac{\sum\limits_{x=1}^{M}
n^{\prime}(a_{i},a_{j},\:d_{ij}(x,k))}{M})$

</tex></equ>
is the expected numberof&lpar;<equ id="equ643" type="inline">
<tex>
$a_i,a_j;\:d_{ij})$

</tex></equ>
pairs averaged over all decoy loopconformations of all target loops in the loop database. Here<equ id="equ644" type="inline">
<tex>
$n^{\prime}(a_{i},a_{j},\:d_{ij}(x,k))$

</tex></equ>
is the number of<equ id="equ645" type="inline">
<tex>
$(a_i,
a_j)$

</tex></equ>
pairs at distance<equ id="equ646" type="inline">
<tex>
$d_{ij}$

</tex></equ>
in the<equ id="equ647" type="inline">
<tex>
$x$

</tex></equ>
&hyphen;th generated loopconformations for the<equ id="equ648" type="inline">
<tex>
$k$

</tex></equ>
&hyphen;th loop. <equ id="equ649" type="inline">
<tex>
$M$

</tex></equ>
is the number of decoysgenerated for a loop, which is set to<equ id="equ650" type="inline">
<tex>
$500$

</tex></equ>
. <equ id="equ651" type="inline">
<tex>
$N$

</tex></equ>
is the number ofloops in our loop database. <equ id="equ652" type="inline">
<tex>
$n^{\prime}_{total}$

</tex></equ>
is the total numberof all atom pairs in the reference state, <equ id="equ653" type="inline">
<tex>
$n^{\prime}_{total}=
\sum\limits_{d_{ij}}\sum\limits_{a_{j}}\sum\limits_{a_{i}}
n^{\prime}(a_{i},a_{j};\:d_{ij})$

</tex></equ>
. </p></section>
<section level="2" id="section23"><title>Tool availability</title><p id="para70"> We have made the source code of {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph> available for download. The URL is at&colon;tanto. bioengr. uic. edu&sol;DiSGro&sol;. </p></section></section></section><section level="1" type="SupportingInformation" id="section23"><title>Supporting Information</title><section level="2" type="supplementary-material" id="section24"><p id="para71" type="label">Text S1</p><section level="3" type="caption" id="section25"><p id="para72" type="p"><emph type="bold">Text S1. Results of modeled loops on Test Set 2 &ndash;5 , calculatedusing {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>. </emph>1 &ndash;3  are tables for Test Set 2 . Table4 &ndash;12  are tables for Test Set 3 . 13 &ndash;18  are tables forTest Set 4 . 19 &ndash;22  are tables for Test Set 5 . Here</p><p id="para73" type="p">&lpar;XXX&rpar;</p></section></section><section level="2" type="supplementary-material" id="section26"><p id="para74" type="label">Text S1</p><section level="3" type="caption" id="section25"><p id="para75" type="p"><emph type="bold">Text S1. Results of modeled loops on Test Set 2 &ndash;5 , calculatedusing {\scDiSGro}D<emph type="smallcaps">i</emph>SG<emph type="smallcaps">ro</emph>. </emph>1 &ndash;3  are tables for Test Set 2 . Table4 &ndash;12  are tables for Test Set 3 . 13 &ndash;18  are tables forTest Set 4 . 19 &ndash;22  are tables for Test Set 5 . Here</p><p id="para76" type="p">&lpar;XXX&rpar;</p></section></section></section></body><back><acks></body><back><acks><title>Acknowledgments</title><p id="para77"> We thank Drs. YoufangCao, Joe Dundas, David Jimenez Morales, Hammad Naveed, Hsiao&hyphen;Mei Lu, and Gamze Gursoy, Meishan Lin, Yun Xu, Jieling Zhao for helpful discussions. </p></acks></acks><refs><title>References</title></article></doc>